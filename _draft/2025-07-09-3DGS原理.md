---
title: 3DGS原理
description: 3DGS前置知识
author: Hatrix
date: 2025-07-09 17:18:00 +0800
categories: [知识储备]
tags: [CV&CG]
math: true
mermaid: true
pin: false
image:
  path: https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250709172108224.png
  alt: 3DGS基础
---

## 概述

3DGS 是基于 Splatting 和机器学习的三维重建方法，从 SfM 生成的点云出发，将点膨胀成三维高斯椭球，再通过光栅化投影到二维平面，与真值图像作 loss，反向传播以调整高斯椭球的参数，最终得到完整的场景描述。

3DGS 中的 Splatting 和 NeRF 中的 Ray-Casting 都是渲染的方法。前者是从粒子出发，计算每个粒子对像素的影响；后者是从像素出发，找到影响这个像素的发光粒子。

## 三维高斯表示

对于 SfM 获得的点云，使用三维的高斯函数进行膨胀。之所以选择高斯椭球而不是立方体或球等其它函数是因为高斯函数具有良好的数学性质，一是高斯函数对仿射变换封闭（渲染中需要用到仿射变换），二是三维高斯沿某一个轴积分成二维后仍为高斯函数（渲染实质上就是投影到二维平面）。

高斯函数的表达式如下（高维高斯均假设各向异性，即不同方向梯度不同）

$$
\begin{aligned}
G(x) &= \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left( -\frac{(x - \mu)^2}{2\sigma^2} \right)\\
G(\boldsymbol{x}) &= \frac{1}{2\pi \sqrt{|\boldsymbol{\Sigma}|}} \exp\left( -\frac{1}{2} (\boldsymbol{x} - \boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1} (\boldsymbol{x} - \boldsymbol{\mu}) \right),\\
&\text{其中 } \boldsymbol{x} = \begin{bmatrix} x_1 \\ x_2 \end{bmatrix},\quad
\boldsymbol{\mu} = \begin{bmatrix} \mu_1 \\ \mu_2 \end{bmatrix},\quad
\boldsymbol{\Sigma} = \begin{bmatrix}
\sigma_{11} & \sigma_{12} \\
\sigma_{21} & \sigma_{22}
\end{bmatrix}\\
G(\boldsymbol{x}) &= \frac{1}{(2\pi)^{3/2} \sqrt{|\boldsymbol{\Sigma}|}} \exp\left( -\frac{1}{2} (\boldsymbol{x} - \boldsymbol{\mu})^\top \boldsymbol{\Sigma}^{-1} (\boldsymbol{x} - \boldsymbol{\mu}) \right),\\
&\text{其中 } \boldsymbol{x} = \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix},\quad
\boldsymbol{\mu} = \begin{bmatrix} \mu_1 \\ \mu_2 \\ \mu_3 \end{bmatrix},\quad
\boldsymbol{\Sigma} = \begin{bmatrix}
\sigma_{11} & \sigma_{12} & \sigma_{13} \\
\sigma_{21} & \sigma_{22} & \sigma_{23} \\
\sigma_{31} & \sigma_{32} & \sigma_{33}
\end{bmatrix}\\
\boldsymbol{\mu}为均值&，决定分布的形状\\
\boldsymbol{\Sigma}为协方&差矩阵，为半正定的对称矩阵，对角线元素为方差，其余元素为协方差，决定分布的形状
\end{aligned}
$$

令二维高斯函数为某一常数，提取各高次项系数并整理之后可以得到一个标准的椭圆方程；几何意义上理解更直观：想象一个平面与钟形曲面相交，截出的曲线就是椭圆。

![image-20250710124024903](../assets/post-pics/image-20250710124024903.png)

三维高斯同理，令其为常数并提取各高次项系数，整理之后就是一个标准的椭球面方程；在几何意义上为了可视化出来，可以想象用颜色来代表函数值，三维高斯函数就是一个实心椭球，从内到外就是颜色渐变的椭球壳。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/untitled.jpg)

任意高斯分布可由标准高斯分布通过放射变换得到，对高斯进行仿射变换满足如下规律

$$
\begin{aligned}
\boldsymbol{x} &\sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})\\
\boldsymbol{y} &= \boldsymbol{A} \boldsymbol{x} + \boldsymbol{b}\\
\boldsymbol{y} &\sim \mathcal{N}(\boldsymbol{A} \boldsymbol{\mu} + \boldsymbol{b},\ \boldsymbol{A} \boldsymbol{\Sigma} \boldsymbol{A}^\top)\\
\end{aligned}
$$

对于标准正态分布，$$\boldsymbol{\Sigma}=\boldsymbol{I}$$，$$\boldsymbol{\Sigma’} = \boldsymbol{A}\boldsymbol{I}\boldsymbol{A}^\top = \boldsymbol{R}\boldsymbol{S}\boldsymbol{S}^\top\boldsymbol{R}^\top$$，因此可用旋转矩阵和缩放矩阵表达协方差矩阵。已知协方差矩阵，也可以通过特征值分解（EVD）的方式求得相应的旋转矩阵和缩放矩阵。

## Splat 过程

Splat 翻译过来有抛雪球、泼溅的意思，指的是在给定相机位姿的条件下，将三维 dianyun 投射到二维图像平面的过程，具体来说可以细分为四个过程：观测变换、投影变换、视口变换和光栅化。

观测变换是从世界坐标系转换到相机坐标系的过程，本质上是仿射变换

## 仿射变换

仿射变换是通过线性变换和平移来改变对象的位置和形状，保持原有对象的直线性和平移性，即二维图形之间的相对位置保持不变，平行线依然是平行线，且直线上的点的位置顺序不变的几何变换；可以实现平移、旋转、缩放和剪切等操作。另外，在进行多个仿射变换时，他们的顺序会影响最终结果。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250710164756686.png)

仿射变换可以表示为乘以一个矩形（这个矩阵又可以分解为旋转矩阵和缩放矩阵的乘积）再加上一个向量的形式。为了方便表示连续的仿射变换，也可以用齐次形式表示

$$
\begin{aligned}
\boldsymbol{y} &= \boldsymbol{A} \cdot\boldsymbol{x} + \boldsymbol{b} = \boldsymbol{R}\boldsymbol{S}\cdot \boldsymbol{x} + \boldsymbol{b}\\
\begin{bmatrix}
\boldsymbol{y} \\
1
\end{bmatrix}
&=
\begin{bmatrix}
\boldsymbol{A} & \boldsymbol{b} \\
\boldsymbol{0}^\top & 1
\end{bmatrix}
\begin{bmatrix}
\boldsymbol{x} \\
1
\end{bmatrix}
\end{aligned}
$$

## 参考资料

[3DGS 原理讲解](https://www.bilibili.com/video/BV1rJ4m1g7Un/)

[仿射变换](https://www.cnblogs.com/wj-1314/p/17633789.html)

[仿射变换矩阵](https://www.cnblogs.com/shine-lee/p/10950963.html)
