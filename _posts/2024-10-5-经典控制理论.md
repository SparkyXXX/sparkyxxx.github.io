---
title: 经典控制理论
description: 课程笔记
author: Hatrix
date: 2024-10-05 18:42:00 +0800
categories: [控制理论]
tags: [课程笔记]
math: true
mermaid: true
---

## 第一章 概述

自动控制理论的发展可分为三个阶段：经典控制理论，现代控制理论，智能控制理论

![image-20250315153037268](../assets/post-pics/image-20250315153037268.png)

控制系统可分为被控对象和控制装置两部分，控制装置可细分为测量元件、比较元件、放大元件、执行机构、给定元件、校正装置。分析系统的工作原理后，可用方框图对系统进行抽象

![image-20250315153102608](../assets/post-pics/image-20250315153102608.png)

控制系统可简单分为开环系统和闭环系统，开环系统简单但精度不高，本课程主要研究闭环系统，闭环系统满足负反馈原理，将输出信号引回输入端比较，利用偏差进行控制，达到减小偏差消除偏差的目的；其工作特点为系统内部存在反馈，信号流动构成回路，且偏差起调节作用。

控制系统按照给定信号的形式可分为恒值系统和随动/伺服系统；按照是否符合叠加原理分为线性系统和非线性系统；按照系统中是否存在脉冲序列或数码形式的信号分为连续系统和离散系统；按照参数是否随时间变化分为定常系统和时变系统；按照输入输出变量的多少分为单变量系统和多变量系统。

## 第二章 数学模型

系统的数学模型，是描述系统输入输出变量以及内部各变量之间关系的数学表达式。得到数学数学模型的方法有解析法和实验法。解析法（机理分析法）针对白盒系统，可以通过物理规律建立方程并得到输入输出间的关系；实验法（系统辨识法）则针对灰盒或黑盒系统，给系统施加测试信号并记录输出响应，用适当的数学模型去逼近系统的输入输出特性。

![image-20250315153720117](../assets/post-pics/image-20250315153720117.png)

在经典控制理论视角下，建模就是从真实系统得到传递函数的过程。系统模型的建立过程可以用以下框图来描述，上半部分是时域方法，下半部分是复数域方法；完全从时域角度建模的过程往往比较繁琐，因此将模型利用拉普拉斯变换转化到复数域内进行操作。

![image-20250315153803219](../assets/post-pics/image-20250315153803219.png)

### 求解微分方程

经典控制原理解决问题的框架建立在线性定常系统上，其时域数学模型为线性常系数微分方程，一般形式如下，一般默认$$r(t)$$为输入，$$c(t)$$为输出（汉语拼音的“入“和”出“）

$$
\begin{aligned}
&a_n \frac{d^n c(t)}{dt^n} + a_{n-1} \frac{d^{n-1} c(t)}{dt^{n-1}} + \ldots + a_1 \frac{dc(t)}{dt} + a_0 c(t)\\
=&b_m \frac{d^m r(t)}{dt^m} + b_{m-1} \frac{d^{m-1} r(t)}{dt^{m-1}} + \ldots + b_1 \frac{dr(t)}{dt} + b_0 r(t)\\
\end{aligned}
$$

线性系统满足叠加原理。线性不线性看变量（注意含常数项属于非线性），定常不定常看系数。

对于非线性系统的微分方程，可在平衡点$$a$$附近展开泰勒级数并忽略高阶项，将方程线性化

$$
\begin{aligned}
f(x) &= f(a) + f'(a)(x - a) + \frac{f''(a)}{2!}(x - a)^2 + \frac{f'''(a)}{3!}(x - a)^3 + \ldots \\
&\approx f(a) + f'(a)(x - a)
\end{aligned}
$$

微分方程的通用解法比较繁琐，一般借助拉普拉斯变换变换到复数域，将微分方程变换为代数方程，求解后再反变换回时域。笔算求反变换的方法称为为部分分式法：将式子拆成常用变换对和性质可直接得出的基本单元，查表求出。

对线性常系数微分方程的一般形式作双边拉普拉斯变换得到（实际系统$$n > m$$）

$$
C(s) = \frac{\left( b_m s^m + b_{m-1} s^{m-1} + \ldots + b_1 s + b_0 \right)}{\left( a_n s^n + a_{n-1} s^{n-1} + \ldots + a_1 s + a_0 \right) } R(s)
$$

给定具体的$$R(s)$$后，可分解$$C(s)$$并求出反变换

- 无重根时

$$
\begin{aligned}
C(s) &= \frac{C_1}{s - \lambda_1} + \frac{C_2}{s - \lambda_2} + \cdots + \frac{C_n}{s - \lambda_n} \\
C_i &= \lim_{s \to p_i}(s - p_i) \cdot F(s) = \lim_{s \to p_i}(s - p_i) \cdot \frac{b_m s^m + b_{m-1} s^{m-1} + \dots + b_0}{(s - p_1) \cdot \dots \cdot (s - p_i) \cdot \dots \cdot (s - p_n)} \\
c(t) &= \mathcal{L}^{-1}[C(s)] = C_1 e^{\lambda_1 t} + C_2 e^{\lambda_2 t} + \cdots + C_n e^{\lambda_n t}
\end{aligned}
$$

其中$$\lambda_i$$为特征根，也称极点；$$e^{\lambda_i}$$称为相对于$$\lambda_i$$的模态，也称振型；模态是构成系统单位脉冲响应最简单的形式，单位脉冲响应是模态的加权组合，对应的系数在复变函数中称为留数。

- 有重根时（设$$p_1$$为$$m$$重根，其余为单根）

$$
\begin{aligned}
C(s) &= \frac{C_m}{(s - p_1)^m} + \frac{C_{m-1}}{(s - p_1)^{m-1}} + \cdots + \frac{C_1}{s - p_1} + \frac{C_{m+1}}{s - p_{m+1}} + \cdots + \frac{C_n}{s - p_n} \\
C_m &= \lim_{s \to p_1} (s - p_1)^m \cdot F(s) \\
C_{m-1} &= \frac{1}{1!} \lim_{s \to p_1} \frac{d}{ds} \left[(s - p_1)^m \cdot F(s)\right] \\
&\vdots \\
C_{m-j} &= \frac{1}{j!} \lim_{s \to p_1} \frac{d^j}{ds^j} \left[(s - p_1)^m \cdot F(s)\right] \\
&\vdots \\
C_1 &= \frac{1}{(m-1)!} \lim_{s \to p_1} \frac{d^{(m-1)}}{ds^{m-1}} \left[(s - p_1)^m \cdot F(s)\right] \\
c(t) &= \mathcal{L}^{-1}[C(s)] = \left[ \frac{C_m}{(m-1)!} t^{m-1} + \frac{C_{m-1}}{(m-2)!} t^{m-2} + \cdots + C_2 t + C_1 \right] e^{p_1 t} + \sum_{i=m+1}^{n} C_i e^{p_i t}
\end{aligned}
$$

### 传递函数

影响系统响应的因素有输入、初始条件和系统的结构参数：输入一般规定为单位阶跃信号$$1(t)$$，因为方便实现并且也是对系统对严苛的输入；初始条件一般规定为零初始条件，实际系统中给输入信号前通常处于平衡状态。于是，系统响应便取决于系统的结构参数，因此为了提高系统响应，就需要根据一定的理论设计系统结构参数。

规定系统在零初始条件下，输出拉氏变换与输入拉氏变换之比，为系统的传递函数。分式中分子和分母的零点分别称为传递函数的零点和极点，零极点包含了丰富的信息，后续详细分析。传递函数只和系统自身的结构参数有关，和微分方程一一对应且可以相互转化。

$$
\frac{C(s)}{R(s)} = \frac{b_m s^m + b_{m-1} s^{m-1} + \cdots + b_1 s + b_0}{a_n s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0} = G(s)
$$

将分子分母首项（最高次）系数化为$$1$$，称为首一标准型

$$
\begin{aligned}
\frac{C(s)}{R(s)} &= \frac{b_m}{a_n}\cdot\frac{s^m + \frac{b_{m-1}}{b_m} s^{m-1} + \cdots + \frac{b_1}{b_m} s + \frac{b_0}{b_m}}{s^n + \frac{a_{n-1}}{a_n} s^{n-1} + \cdots + \frac{a_1}{a_n} s + \frac{a_0}{a_n}} = G(s)\\
G(s) &= \frac{K^* \prod_{j=1}^{m} (s - z_j)}{\prod_{i=1}^{n} (s - p_i)}
\end{aligned}
$$

类似的，将分子分母尾项（最低次，不一定是常数项）化为$$1$$，称为尾一标准型。尾一标准型前的系数$$K$$称为增益

$$
\begin{aligned}
\frac{C(s)}{R(s)} &= \frac{b_0}{a_0}\cdot\frac{\frac{b_m}{b_0} s^m + \frac{b*{m-1}}{b_0} s^{m-1} + \cdots + \frac{b_1}{b_0} s + 1 }{\frac{a_n}{a_0} s^n + \frac{a_{n-1}}{a*0} s^{n-1} + \cdots + \frac{a_1}{a_0} s + 1} = G(s)\\
G(s) &= K \frac{\prod_{k=1}^{m_1} (\tau_k s + 1) \prod_{l=1}^{m_2} (\tau_l^2 s^2 + 2 \tau_l \xi_l s + 1)}{s^v \prod_{i=1}^{n_1} (T_i s + 1) \prod_{j=1}^{n_2} (T_j^2 s^2 + 2T_j \xi_j s + 1)}
\end{aligned}
$$

注意，负号不用提出来，要保证$$K^*$$或$$K$$为正

传递函数是单位脉冲响应的拉氏变换，与系统零极点图对应。原则上，传递函数不反映非零初始条件时系统响应的全部信息，适合于描述 SISO 系统，且只能用于表示线性定常系统。

### 典型系统框图

![image-20250315165131873](../assets/post-pics/image-20250315165131873.png)

- 开环传递函数：将闭环系统主反馈通路断开对应的开环传递函数，化为尾一标准型后的系数称为开环增益

  $$
  G(s)N(s) = \frac{B(s)}{E(s)} = G_1(s)G_2(s)H(s)
  $$

- 输入作用下的闭环传递函数：根据输出的不同选取，分为输入作用下的闭环传递函数和误差传递函数。使闭环传递函数分母为零的方程称为特征方程，单位反馈的特征方程为开环传递函数分子分母之和。

  $$
  \begin{aligned}
  \Phi(s) &= \frac{C(s)}{R(s)} = \frac{G_1(s)G_2(s)}{1 + G_1(s)G_2(s)H(s)} \\ \Phi_e(s) &= \frac{E(s)}{R(s)} = \frac{1}{1 + G_1(s)G_2(s)H(s)}\\
  \end{aligned}
  $$

- 干扰作用下的闭环传递函数：同理分为干扰作用下的闭环传递函数和误差传递函数

  $$
  \begin{aligned}
  \Phi_n(s) = \frac{C(s)}{N(s)} = \frac{G_2(s)}{1 + G_1(s)G_2(s)H(s)} \\ \Phi_{en}(s) = \frac{E(s)}{N(s)} = \frac{-G_2(s) \cdot H(s)}{1 + G_1(s)G_2(s)H(s)}\\
  \end{aligned}
  $$

- 系统总输出和总误差：根据叠加原理，为两个输入分别作用时的输出之和/误差之和

  $$
  \begin{aligned}
  C(s) &= \frac{G_1(s)G_2(s) \cdot R(s)}{1 + G_1(s)G_2(s)H(s)} + \frac{G_2(s) \cdot N(s)}{1 + G_1(s)G_2(s)H(s)} \\
  E(s) &= \frac{-R(s)}{1 + G_1(s)G_2(s)H(s)} + \frac{-G_2(s) \cdot H(s) \cdot N(s)}{1 + G_1(s)G_2(s)H(s)}\\
  \end{aligned}
  $$

### 典型环节

将数学模型形式相同的元件归为同一类，称为环节；将其中最常用最具代表性的环节总结出来，称为典型环节

![image-20250315165744042](../assets/post-pics/image-20250315165744042.png)

任意传递函数分解开化为尾一标准型，都是典型环节的乘积，即典型环节可看作构成传递函数的基本单元。不同的元部件可以有相同的传递函数，同一元部件选择不同的输入输出变量也可以有不同的传递函数。

另外，需要注意传递函数的负载效应问题，比如下图中是否将$$u_a$$断开来分析$$u_c$$和$$u_r$$之间的传递函数，得到的结果是不同的

![image-20250315165917689](../assets/post-pics/image-20250315165917689.png)

### 结构图及等效变换

将方框图的各个元件都转化为环节，就得到了系统的结构图；另外，也可以描述系统的各个微分方程拉氏变换为子结构图，再连接得到系统的结构图。结构图已经可以精确描述系统的输入输出关系。

从结构图得到传递函数的一个方法是在结构图上进行等效化简，化简规则如下

![image-20250315170031804](../assets/post-pics/image-20250315170031804.png)

化简的窍门是：先观察相邻的比较点和引出点，尝试比较点之间和引出点之间互换以简化问题；如果不能得到简化，就需要交换比较点和引出点。

### 梅森增益公式

从结构图得到传递函数的另一种方法是梅森增益公式，梅森增益公式原本是建立在信号流图基础上的。为了介绍梅森增益公式，先介绍信号流图及相关概念。信号流图与结构图等价，是由节点和支路组成的信号传递网络，节点代表物理量，支路和支路增益分别代表环节和环节传递函数。既有输入又有输出的混合节点，在转化为方框图时先比较再引出。前向通路是从输入节点到输出节点传递时，每个节点只通过一次的通路；回路是起点和终点重合，且信号通过每一节点不多于一次的闭合通路；回路之间没有公共节点叫不接触回路。

![image-20250315170154892](../assets/post-pics/image-20250315170154892.png)

梅森增益公式：

$$
G(s) = \frac{1}{\Delta} \sum\_{k=1}^{n} P_k \Delta_k
$$

其中，$$\Delta = 1 - \sum L_a + \sum L_b L_c - \sum L_d L_e L_f + \ldots$$为特征式，$$\sum L_a、\sum L_b L_c、\sum L_d L_e L_f$$分别为所有回路增益之积、两两互不接触回路之积、三个互不接触回路之积，$$n$$为前向通路条数，$$P_k$$为第$$k$$条前向通路的总增益，$$\Delta_k$$为第$$k$$条前向通路的余子式（去掉与第$$k$$条前向通路接触的回路，剩余回路构成的子特征式）。

## 第三章 时域分析与校正

时域法直接在时间域中分析和校正系统，可以系统系统时间响应的全部信息，直观而准确，但基于求解系统输出的解析解比较繁琐，一方面是对于高阶系统难以计算解析解，另一方面是每次修改系统结构参数都需要重新计算。

### 时域动态性能指标

动态性能指标在阶跃响应下定义

1. 延迟时间$$t_d$$：第一次达到终值 50%的时间
2. 上升时间$$t_r$$：对于无振荡的系统，指响应从终值 10%上升到终值 90%的时间；对于有振荡的系统，指从零第一次上升到终止所需的时间
3. 峰值时间$$t_p$$：响应超过其终值并达到第一个峰值所需要的时间，是极值点；令一阶导等于 0 可得
4. 调节时间$$t_s$$：响应到达并保持在终值 5%或 2%以内的所需的最短时间
5. 超调量$$\sigma\%$$：指响应的最大偏移量与终值的差与终值与初值的差的百分比

常用上升时间，调节时间评价响应速度，用超调量评价阻尼程度。

![image-20250315171344296](../assets/post-pics/image-20250315171344296.png)

动态性能指标的求解方式：由系统结构图求传递函数，再得到输出表达式，再根据定义计算即可 。

改变闭环增益或输入信号乘一个系数，不影响动态性能指标。减小开环增益可以减小系统超调量（减小稳态误差）

### 一阶系统

典型结构，其中$$T$$为时间常数

![image-20250315171628775](../assets/post-pics/image-20250315171628775.png)

开环传递函数：$$\Phi(s) = \frac{1}{Ts}$$

闭环传递函数：$$\Phi(s) = \frac{1}{Ts + 1}$$

动态性能指标上，$$t_s = 3T$$

一阶系统典型响应如图：

![image-20250315171747391](../assets/post-pics/image-20250315171747391.png)

### 二阶系统

典型结构，其中$$\xi$$为阻尼比，$$\omega_n$$为无阻尼自然频率，$$\sigma = \zeta \omega_n$$称为衰减系数，$$\omega_d = \omega_n \sqrt{1 - \zeta^2}$$称为阻尼振荡频率($$\xi \ge 1$$时没有这个概念)，$$\beta = \arccos \zeta$$称为阻尼角

![image-20250315171836248](../assets/post-pics/image-20250315171836248.png)

开环传递函数：$$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_ns}$$

闭环传递函数：$$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

根据$$\xi$$的不同，二阶系统的典型响应形式也有差异：

![image-20250315171910148](../assets/post-pics/image-20250315171910148.png)

![image-20250315171918805](../assets/post-pics/image-20250315171918805.png)

动态性能指标上，对临界阻尼和过阻尼，超调量为 0，计算调节时间。解出分母特征方程的根$$\lambda_1、\lambda_2$$，$$\lambda_1 = -\frac{1}{T_1}$$，$$\lambda_2 = -\frac{1}{T_2}$$，得到$$\frac{T_1}{T_2}$$，查阅$$\frac{t_s}{T_1}-\frac{T_1}{T_2}$$的函数关系，即可得到$$t_s$$。

对欠阻尼，可按照流程正常求取动态性能指标，得$$t_p = \frac{\pi}{\omega_d} = \frac{\pi}{\sqrt{1-\xi^2}\omega_n}$$、$$\sigma\% = e^{\frac{-\xi\pi}{\sqrt{1-\xi^2}}} \times 100\%$$（注意超调量只与阻尼比有关）

欠阻尼响应曲线在包络线之间衰减振荡，其调节时间按照包络线计算，结果为$$t_s \approx \frac{3.5}{\omega_n}（5\%误差带）$$或$$t_s \approx \frac{4}{\omega_n}（2\%误差带）$$。当$$\omega_n$$确定时，$$\xi = 0.707$$（最佳阻尼比）时，$$t_s$$实际最小。（欠阻尼时才有这个公式，过阻尼没有）

![image-20250315172148542](../assets/post-pics/image-20250315172148542.png)

欠阻尼二阶系统动态性能随极点位置的变化规律

![image-20250315172431317](../assets/post-pics/image-20250315172431317.png)

---

**改善二阶系统动态性能的措施**

此处介绍两种方式：测速反馈和比例微分，测速反馈本质上是增加阻尼（如 PID 控制中的内环），用于系统阻尼不够的情况；而比例微分则实际上是提前控制。引入误差的比例微分控制可减小系统超调量。

![image-20250315172526720](../assets/post-pics/image-20250315172526720.png)

### 高阶系统

离虚轴较近的极点称为主导极点，决定响应曲线的大致形状；而离虚轴较远的极点其对应模态衰减迅速，对响应曲线贡献不多。一般的物理系统都可以用一阶、二阶系统来表示。而在实际系统中，往往因为有局非线性环节或误差的存在，实际的系统模型可能不止二阶，此时会略去非主导零极点和不非常靠近虚轴的偶极子，保留主导极点，将系统近似为低阶系统。根据相应的经验公式估算性能指标。

### 时域稳定性分析

稳定是控制系统正常工作的首要条件。在扰动作用下系统偏离平衡位置，如果扰动消除后系统能够以足够的准确度恢复原来的平衡状态，则系统是稳定的，否则不稳定（注意将临界稳定也归为不稳定）。系统的稳定性是自身的属性，与输入无关。

稳定的充要条件是，系统单位脉冲响应终值为 0，即$$\lim_{t \to \infty} k(t) = 0$$。根据输出表达式$$k(t) = \sum_{i=1}^n A_i e^{\lambda_i t}$$可得，该条件等价于系统所有闭环极点具有负实部，即严格位于$$s$$平面左半面。极点由特征多项式决定，特征多项式由系统结构图的回路决定，前馈通道不构成回路因此不影响稳定性。另外，开环稳定与闭环稳定之间没有联系。

对于高阶系统，找出所有极点逐一判断是否位于左半面是困难的，因此需要稳定性判据以简化操作。

- 必要条件：将特征多项式最高次项系数化为正，若所有系数均严格大于 0，才有可能稳定（注意缺项表示系数为 0，一定不稳定）。
- 劳斯判据：由特征多项式列劳斯表，注意特殊情况处理，第一列全为正且没有特殊情况造成的虚轴或右半平面的根，则系统稳定。

### 稳态误差

稳态性能指标：稳态误差，是对系统控制精度的度量。理论分析中一般指考虑系统的原理性误差，而不考虑由于局部非线性引起的误差。在阶跃输入作用下没有原理性误差的系统称为无差系统，反之称为有差系统。

稳定性由稳态误差定量描述，分为按输入端定义的（又称偏差）和按输出端定义的

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/0bc57e57-5481-4509-8aa7-60aa806d7485/image.png)

根据系统是否稳定又可分为静态误差和动态误差：系统稳定时为误差在时间趋于无穷时的常值$$e_{ss}$$；系统不稳定时为误差中的稳态分量$$e_s(t)$$。稳态速度误差表示，输入速度信号时的位置误差。

稳态误差计算的一般方法为：判定函数稳定性—>求误差传递函数$$\Phi_e(s) = \frac{E(s)}{R(s)}、\Phi_{en}(s) = \frac{E(s)}{N(s)}$$—>终值定理求稳态误差$$e_{ss} = \lim_{s \to 0} s \left[ \Phi_{e}(s) R(s) + \Phi_{en}(s) N(s) \right]$$

影响$$e_{ss}$$的因素包括系统自身的结构参数、外作用的类型（控制量、扰动量以及作用点）、外作用的形式（阶跃、斜坡、加速度）

注意：系统是否问题，与系统稳态误差是否为无穷大，是两个截然不同的概念。讨论稳态误差时，默认系统已经稳定了。

---

除了一般方法，计算静态误差还有静态误差系数法，用于计算**无前馈作用**时，**输入作用**下的稳态误差

闭环系统的开环传递函数如下，其中$$K$$为开环增益，$$v$$为系统型别（开环传递函数中积分环节的个数）（注意两个量都是针对**开环传递函数**而言的）（补充：一阶无差系统指跟踪阶跃信号无稳态误差，且含有一个纯积分环节）

$$
G(s) = G_{1}(s)H(s) = \frac{K(\tau_{1}s+1) \cdots (\tau_{m}s+1)}{s^{v}(T_{1}s+1) \cdots (T_{n-v}s+1)} = \frac{K}{s^v}G_{0}(s)\\ \lim_{s \to 0} G_{0}(s) = 1

$$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/51670381-bcfa-46b3-8e59-977ae9991247/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/5eaad565-c540-4d78-98e3-2aae07ea0df8/image.png)

增加积分环节可减小静态误差，但另一方面，积分环节的增加使得闭环时的特征多项式缺项的可能性更大，在开环传递函数中需要加更多的符合微分环节才可能使系统稳定，即使系统稳定的难度提高了。

在主反馈口到干扰作用点之间的前向通道中提高增益、设置积分环节，可以同时减小或消除控制输入和干扰作用下产生的稳态误差。

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/c2d07315-d5f7-4148-9f08-a1ae5b0c52e8/image.png)

静态误差系数法只能求出误差的稳态值$$e_{ss}$$，无法获得其随时间变化的规律，而动态误差系数法可以获得误差中稳态分量$$e_s(t)$$随时间的变化规律。

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/8fcdc7d7-04d8-40d1-b0dd-a9ca5fc250ca/image.png)

实际系统中，输入$$r(t)$$为$$t$$的有限次多项式，求导几次后就为 0 了，因此$$e_s(t)$$也是有限项的多项式；另外，实际系统中，有时不要求系统在时间无穷时误差稳定，只要求在一定时间内，系统误差不超过某个阈值即可，所以动态误差系数法是有意义的。

### 时域校正

校正是指，在系统中加入一些结构和参数可调整的装置（校正装置），以改善系统性能，满足指标要求。校正方式有：串联校正（如比例微分控制）、反馈矫正、前馈校正（顺馈校正）、复合校正。

反馈校正：

- 反馈可以减小被包围环节的时间常数，但同时也会减小增益，通常配合增益补偿使用。

  ![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/9e8dd45a-231c-49ae-b1cf-9e7a7d848b76/image.png)

$$ G(s) = \frac{K}{T s + 1} \quad G'(s) = \frac{K}{T s + 1 + KK*{h}} = \frac{K'}{T' s + 1} \\ T' = \frac{T}{1 + KK*{h}} < T \quad K'=\frac{K}{1 + KK\_{h}} < K $$

- 深度负反馈可降低被包围环节的影响。

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/83c1b46d-f49e-46df-b25a-62430c3678b3/image.png)

$$ \Phi(s) = \frac{G(s)}{1 + G(s)H(s)} \quad G(s)H(s) \gg 1 \\\Phi(s) = \frac{G(s)}{1 + G(s)H(s)} \approx \frac{1}{H(s)} $$

- 局部正反馈可提高环节增益，但同时也会增大时间常数

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/d7547b81-64b7-4feb-8559-e60efe4e5f13/image.png)

$$ \Phi(s) = \frac{\frac{K}{Ts+1}}{1-\frac{KK*h}{Ts+1}} = \frac{K}{TS+1-KK_h}=\frac{\frac{K}{1-KK_h}}{\frac{T}{1-KK_h}s+1} = \frac{K'}{T's+1} \\ K' = \frac{K}{1 - KK*{h}} > K \quad T' = \frac{T}{1 - KK\_{h}} > T $$

---

前馈校正

- 前馈校正可通过设计，减小甚至消除系统稳态误差；可分别根据输入和根据干扰设计前馈环节，消除在两种输入同时作用下的稳态误差。

## 第四章 根轨迹法

根轨迹法是三大分析校正方法之一，是一种直观形象的图解方法，适合于研究系统某一参数变化时，系统性能的变化趋势。定义为：系统某一参数从$$0 \to \infty$$变化时，**闭环极点**在$$s$$平面相应变化描绘出的轨迹。

根轨迹法的根本任务在于，由已知的开环零级点分布以及根轨迹增益，通过图解的方式，找出闭环极点；从而确定闭环传函的形式，反变换得到闭环时间响应。（由开环传函得闭环性质）

根轨迹法研究时，习惯把开环传递函数写成首一标准型，其系数称为根轨迹增益，根轨迹增益的概念仅针对开环而言。但根轨迹一定是闭环根轨迹，没有开环根轨迹的说法。由于开环传递函数写成尾一标准型时，对应的系数称为开环增益，因此开环增益与根轨迹增益之间存在比例关系

$$ K = K^{\*} \frac{\prod*{i=1}^{m} |z_i|}{\prod*{j=1}^{n} |p_j|} $$

### 零极点分析

- 对于动态性能指标：极点决定响应模态形式，零点影响响应模态系数，均影响动态性能。
- 响应分量的衰减速度与极点实部值和该处留数有关，即闭环零极点的相互位置。
- 对于稳定性：系统稳定与否只取决于闭环极点，与闭环零点无关。
- 极点与频率轴上某个频率对应时，会导致该频率处的增益降低或相位滞后；零点与频率轴上某个频率对应时，会导致该频率处的增益增加或相位提前
- 在系统中附加开环负实数零点，可把根轨迹向左拉，有利于提高动态性能；附加开环极点，会把轨迹向右拉。越靠近虚轴作用越强。加开环零极点会影响原有闭环零极点，且要把附加环节设计在闭环里边。附加闭环极点增大阻尼，减小超调量，峰值时间滞后，调节时间不一定；附加闭环零点减小阻尼，增大超调量，峰值时间提前，调节时间不一定。加闭环零极点不影响原有闭环零极点，且要加在闭环外边。无论开环闭环，零极点离虚轴越近作用越明显。
- 开环零极点和闭环零极点之间的关系：

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/cf1261b1-e1f3-456c-990d-a025274bb850/image.png)

观察可得：闭环零点为前向通路开环零点+反馈通路开环极点，不随根轨迹增益变化而变化；闭环极点与开环零极点和根轨迹增益（也是开环概念）均有关系，因此根轨迹法可以做到由开环传递函数研究闭环极点。

注意：根轨迹只会给出随着根轨迹增益变化而变化的闭环极点轨迹，对于不随根轨迹变化的闭环极点以及所有闭环零点，根轨迹是体现不出信息的。

### 根轨迹方程

闭环极点满足特征方程，将特征方程稍加变形便得到根轨迹方程。

设系统有 m 个开环零点和 n 个开环极点

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/06c35e33-894b-4c10-b67a-252fb2e5557b/image.png)

$$ G(s)H(s) = K^{_} \frac{\prod*{i=1}^{m}(s - z_i)}{\prod*{j=1}^{n}(s - p_j)} \\ \Phi(s) = \frac{G(s)}{1 + G(s)H(s)} \\ K^{_} \frac{\prod*{i = 1}^m(s - z_i)}{\prod*{j = 1}^n(s - p_j)} = -1 $$

将该向量方程拆开便可以得到根轨迹上的点应该满足的相角条件和幅值条件

$$ \sum*{i = 1}^m \angle(s - z_i) - \sum*{j = 1}^n \angle(s - p*j) = (2k + 1) \pi \\ K^{\*} = \frac{\prod*{j = 1}^n|s - p*j|}{\prod*{i = 1}^m|s - z_i|} $$

一般由相角条件判断某个点是否在根轨迹上（是否为特征根），若在根轨迹上再由幅值条件求出该点对应的根轨迹增益。反过来说，想放置极点在某一特定位置，只需要调整根轨迹增益即可。

### 根轨迹绘制法则

- 法则一：根轨迹起始于开环极点，终止于开环零点；如果开环极点个数 n 大于开环零点个数 m，则有 n-m 条根轨迹终止于无穷远处。
- 法则二：根轨迹的分支数=开环极点数；根轨迹连续且对称于实轴。若开环零极点均为偶数个，且关于一条平行于虚轴的直线左右对称分布，则根轨迹一定关于该直线左右对称。
- 法则三：从实轴上最右端的开环零、极点算起，奇数开环零极点到偶数开环零极点之间的区域必是根轨迹；反之在这个区域之外的必不是根轨迹。
- 法则四：$$n-m ≥ 2$$时，闭环根之和保持一个常值$$\sum_{i=1}^{n} p_i = -a_{n-1}$$；一部分根左移，另一部分根必定右移。定理：若系统有 2 个开环极点，1 个开环零点，且在复平面存在根轨迹，则复平面的根轨迹一定是以该零点为圆心的圆弧。
- 法则五：$$n > m$$时，$$n-m$$条（无零点归宿的）根轨迹沿渐近线趋于无穷远，渐近线与实轴交点和实轴正方向夹角满足

$$
\sigma_a = \frac{\sum_{i=1}^{n} p_i - \sum_{j=1}^{m} z_j}{n - m}\\ \varphi_a = \frac{(2k + 1)\pi}{n - m}

$$

- 法则六：根轨迹在实轴上分离点坐标$$d$$和分离角$$\phi$$满足下式，无零点时右端为 0，$$l$$为根轨迹条数

$$ \sum*{i=1}^{n} \frac{1}{d - p_i} = \sum*{j=1}^{m} \frac{1}{d - z_j}\\ \phi = \frac{(2k+1)\pi}{l} $$

- 法则七：与虚轴交点是系统临界稳定点，对应特征根为$$s = j\omega$$，具体值可在特征方程（注意是闭环传递函数的分母）中令$$s = j\omega$$，实部虚部分别为 0 解出$$\omega$$和$$K^*$$（注意开环增益和根轨迹增益之间有个比例关系）；或由劳斯表构造全零行，通过辅助方程求出。
- 法则八：根轨迹离开开环复数极点的出射角（又称起始角），进入开环复数零点的入射角（又称终值角）满足下式（补一个距离计算点极小的点零点或极点（算出射角补零点，算入射角补极点），将店与计算点连线与实轴正方向夹角认为是出射角或入射角）

$$ \sum*{j=1}^{m} \angle(s - z_j) - \sum*{i=1}^{n} \angle(s - p_i) = (2k + 1)\pi $$

小结：绘制根轨迹的步骤大致为，画出开环零极点，画实轴上的根轨迹，对于没有归宿的根轨迹，再根据需要计算渐近线、分离点，穿过虚轴时计算交点，不在实轴上的点需要计算出射角或入射角。

### 参数根轨迹

除$$K^*$$外其它参数变化时的根轨迹称为参数根轨迹（广义根轨迹）。绘制参数根轨迹的方法为，由闭环传递函数写出将特征方程，含参部分作为分子，其余部分作为分母（但当这样做导致分子次数较高时需要含参部分作为分母，其余部分作为分子，然后变形为参数的倒数放在分子），构成等效开环传递函数，形式便与正常根轨迹一样了。注意等效开环传递函数仅可用于绘制参数根轨迹，其余计算分析需用原始传递函数。

系统处于正反馈时的根轨迹称为零度根轨迹，根轨迹方程右边从-1 变为 1，绘制法则中涉及相角条件的渐近线夹角、出射角入射角从$$(2k+1)\pi$$变为$$2k\pi$$，以及实轴根轨迹变为偶数开环零极点到奇数开环零极点之间的区域是根轨迹。其余法则不变。

根轨迹不作特殊说明，参数为根轨迹增益，且为 180° 根轨迹（常规根轨迹）。

### 根轨迹法分析动态性能

事实上，计算机中可以很方便地绘制准确的根轨迹，相较于手绘根轨迹的法则，更重要的其实是解析根轨迹蕴含的丰富信息。根轨迹可以知道参数变化时闭环极点的变化，闭环极点的位置，就对应了系统性能指标；因此，由根轨迹图，就可以知道参数如何变化才能满足性能要求。另外，在根轨迹 / 零极点图上，还可以由几何方法分析求取系统函数在某一复数上的值；通过对该向量终点和零极点相连所构成的向量进行运算，可以得到系统函数在该复数上的值。

用根轨迹法分析动态性能的步骤为：绘制根轨迹、由指标要求确定闭环极点位置（相角条件、模值条件、解根、试根、根之和、比较系数、长除法……）、确定闭环零点（前向通道开环零点+反馈通道开环极点）（注意此步需要写出完整的传递函数，并标出完整的闭环零极点）、保留主导极点（注意增益要保留下来）并估算系统性能

PID 控制器的根轨迹

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/e50d75c6-6479-43ce-bf36-7295c0d86331/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/140030b4-3569-431b-838d-2067e164b230/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/efec4268-7c3a-4c25-b0fe-a8317794afe1/image.png)

根轨迹法也可以校正系统，为三大校正方法之一。但根轨迹法可以校正的系统，频率法一定可以校正且更加便捷。

## 第五章 频域分析与校正

研究稳态正弦响应的幅值和相角随频率的变化规律，由开环或闭环频率特性研究闭环稳定性及性能（工程上用得最广泛的还是开环频率特性），使用图解法方便直观但有一定的近似性。

### 频率特性

频率响应：系统在正弦信号激励下，响应的稳态分量，一定是和输入信号同频率的正弦信号，幅值和相角有所改变且都是$$\omega$$的函数，称为系统的频率响应。稳态输出于输入信号的幅值之比随频率变化的规律称为幅频特性。稳态输出于输入信号的相角之差随频率变化的规律称为相频特性。幅频特性和相频特性合起来叫频率特性（稳态正弦响应对输入信号的幅值比和相角差）。另一种定义是，令系统传递函数$$G(s)$$的$$s=j\omega$$，得到的复数便是频率特性。同时，也可以定义为稳态输出和输入的傅立叶变换之比。

注意：用频率特性只能求得稳态输出。

---

频率特性有四种表示方式：幅频相频曲线、幅相特性曲线、对数特性曲线、对数幅相特性。

- 对数幅相特性曲线：又称 Nichols 图，横轴为相频特性，纵轴为对数幅频特性

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/461e447e-dfdb-4455-883f-7cc420efce47/image.png)

### Nyquist 图

Nyquist 图（又称幅相特性曲线）是函数复平面$$[G]$$平面的极坐标图，曲线起于$$\omega=0$$终于$$\omega=\infty$$；从原点指向曲线上的箭头，长度代表幅频特性，与$$\omega$$轴正方向夹角代表相频特性。Nyquist 图常用于理论分析；典型环节的 Nyquist 图如下

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/d36c4818-37a5-4888-b5ed-9b5ce0fa704d/image.png)

其中，振荡环节和二阶复合微分环节是一族曲线，$$\xi$$和$$\omega_n$$确定后可以定下具体曲线；另外振荡环节在$$\xi < 0.707$$时有谐振频率$$\omega_r$$和谐振峰值$$M_r$$的概念，令$$|G(j\omega)|$$对$$\omega$$求导为 0 可得$$\omega_r$$，代入$$|G(j\omega)|$$可得$$M_r$$

谐振峰值$$M_r = \frac{1}{2\xi\sqrt{1-\xi^2}}$$，谐振频率$$\omega_r = \omega_n\sqrt{1-2\xi^2}$$

任意开环可看作由典型环节叠加而成，幅值根据传递函数对应乘除、相角根据传递函数对应加减；绘制其幅相特性曲线，先确定起终点，后根据$$s$$平面矢量变化规律推断曲线中间部分，求出与实轴和虚轴的交点。

### Bode 图

又称对数频率特性曲线，使用对数坐标，分别表示幅值比和相角差随$$\omega$$的变化规律；其中幅频特性取$$L(\omega) = 20 \lg |G(j\omega)|$$，相频特性仍为$$\angle G(j\omega)$$。Bode 图常用于工程实践。绘制在半对数坐标纸上，横坐标按照$$\lg\omega$$对数刻度，称为十倍频程/旬距；按照$$\omega$$标定，等距等比。这样，横轴在低频段画的比较开，高频段化的比较紧密，且能够涵盖很广的频率范围，符合工程需要。纵坐标按照$$20\lg|G(j\omega)|$$刻度，单位为分贝。取对数将幅值相乘变为对数相加便于叠加作图。 Bode 图中，$$L(\omega) = 0$$对应的$$\omega$$称为截止频率。典型环节的 Bode 图如下：

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/0ebcf9e1-1f6e-45bb-8a94-992039c2a331/image.png)

其中，振荡环节和二阶复合微分环节是一族曲线，$$\xi$$和$$\omega_n$$确定后可以定下具体曲线；

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/d0740401-7158-4ef5-a385-d9f377fb2cf7/image.png)

- 非最小相角系统：右半$$s$$平面存在开环零极点，或带纯延时环节的系统。非最小系统相角变化的绝对值一般比最小相角系统大，未必要画 0° 根轨迹，也未必不稳定（存在不稳定开环极点不影响；另一方面，闭环稳定性和开环稳定性无关）。最小相角系统由$$L(\omega)$$可以唯一确定$$G(s)$$，非最小相角系统则不能。

### 频域稳定判据

包括 Nyquist 判据和对数稳定判据，由开环频域特性可以直接判定闭环系统的稳定性，可以研究包含延迟环节的系统稳定性，可研究如何调整系统结构参数改善系统稳定性及性能问题

**Nyquist 判据**

Z = P - 2N，Z 为右半平面闭环极点个数，P 右半平面开环极点个数，N 为幅相特性曲线在 G 平面包围$$(-1, j0)$$的圈数（称为奈氏路径）（顺时针包围为负，逆时针包围为正，穿过时为临界稳定）；即，画出幅相特性曲线找出 N 后可计算出 Z，从而判断闭环稳定性。

注意当$$s$$平面虚轴上有开环极点时，奈氏路径要从右边绕出半径无穷小的圆弧，$$G$$平面对应补充大圆弧，从$$0\to 0^+ \to \infty$$把路径走全。N 的最小单位为$$\frac{1}{2}$$

**对数稳定判据**

公式不变，N 的判断从 Bode 图上看，在$$L(\omega)$$的范围内，看$$\varphi(\omega)$$穿越-180° 的情况，从上往下穿越为负，从下往上穿越为正。

### 稳定裕度

开环频率指标，描述到$$(-1, j0)$$的距离，表示闭环稳定性。由定义截止频率$$\omega_c$$满足$$|G(j\omega_c)| = 1$$，相角交界频率$$\omega_g$$满足$$\angle G(j\omega_g) = -180\degree$$，稳定裕度定义为

$$ \begin{aligned} &相角裕度 \quad \gamma = 180\degree + \angle G(j\omega_c)\\ &幅值裕度 \quad h = \frac{1}{|G(j\omega_g)|}\\ \end{aligned} $$

稳定裕度表征了系统在相角和幅值上距离临界稳定的余量，一般要求$$\gamma > 40\degree, h > 2$$；描述闭环系统稳定的程度。对于最小相角系统，可以由相角裕度为正判定系统稳定。

由 Nyquist 图求相角裕度需要由$$|G(j\omega_c)| = 1$$解出$$\omega_c$$，再代入相角裕度公式即可；求幅值裕度可以由$$\angle G(j\omega_g) = -180\degree$$解出$$\omega_g$$，再代入幅值裕度公式即可；或令频率特性虚部为 0 解出$$\omega_g$$也可。用 Bode 图求相角裕度，解$$|G(j\omega_c)| = 1$$时，每一项乘积因子可以保留主要部分近似计算（因为 Bode 图本身画的是近似曲线，可以由三角形比例关系解出结果）

### 开环频域性能分析

三频段理论：$$L(\omega)$$低频渐近线影响稳态误差，中频段影响动态性能，高频段影响抗高频干扰能力。低中高频没有明确的界限，是相对的概念，且三频段理论只适用于单位反馈的最小相角系统。

低频段$$G_0(s) = \frac{K}{s^v}$$，$$20lg|G_0(s)| = 20lgK - v\cdot20lg\omega$$，$$\angle G_0 = -v\cdot 90\degree$$。低频段曲线给定后，开环增益和系统型别也就确定了，稳态误差可以完全根据输入确定。

中频段影响动态性能（$$\sigma\%、t_s$$），对于最小相角系统，$$L(\omega)$$与$$\varphi(\omega)$$一一对应，为保证$$\gamma > 40\degree$$，希望$$L(\omega)$$以$$-20\text{dB/dec}$$斜率穿越$$0\text{dB}$$线，并保持较宽的频段 ，相角裕度较大，动态性能指标较好。

高频段影响高频干扰能力，高频段曲线越低（衰减越厉害），开环系统抗干扰能力越强，由

$$ \Phi(s) = \frac{G(s)}{1 + G(s)}，当|G(s) \ll 1|时，|\Phi(s)|\approx|G(s)| \ll 1 $$

即闭环抗干扰能力也强。

三频段给出了调整系统结构、改善系统性能的原则和方向，希望低频段陡且高，中频段缓且宽，高频段陡且低。

对于欠阻尼二阶系统$$G(s) = \frac{\omega_n^2}{s(s + 2\xi\omega_n)}$$，$$K = \frac{\omega_n}{2\xi}、v = 1$$，根据$$|G(j\omega_c)| = 1$$可得

$$ \omega_c = \sqrt{\sqrt{4\xi^4 + 1} - 2\xi^2}\cdot \omega_n\\ \gamma = 180\degree + \varphi(\omega_c) = \arctan\frac{2\xi\omega_n}{\omega_c} = \arctan\frac{2\xi}{\sqrt{\sqrt{4\xi^4 + 1} - 2\xi^2}}\\ \sigma\% = e^{-\frac{\pi\xi}{\sqrt{1 - \xi^2}}} $$

因此，相角裕度$$\gamma$$、超调量$$\sigma\%$$都是阻尼比$$\xi$$的单值函数；同时由下式可以建立$$t_s\omega_c$$和$$\gamma$$的单值函数关系

$$ t_s\omega_c = \frac{3.5}{\xi\omega_c} \cdot \sqrt{\sqrt{4\xi^4 + 1} - 2\xi^2}\cdot \omega_n = \frac{7}{\tan\gamma} $$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/efdaabcc-ea07-468d-8cdf-baf6b7bb8d8f/image.png)

因此，可以由欠阻尼二阶系统的开环传递函数计算相角裕度（频域性能指标），再查表得到超调量和调节时间（时域性能指标）。

对于低阶系统，时域法也有准确的公式计算性能指标，因此用频域法计算的优势并不明显。而对于高阶系统，由于有如下用于估算的经验公式和对应的函数关系。$$(35\degree \le \gamma \le 90\degree)$$时精确程度较高

$$ \sigma\% = \left[ 0.16 + 0.4\left(\frac{1}{\sin\gamma} -1\right) \right]\times 100\%\\ t_s = \frac{\pi}{\omega_c}\left[ 2 + 1.5\left(\frac{1}{\sin \gamma } - 1\right) + 2.5 \left(\frac{1}{\sin \gamma } - 1\right)^2 \right] $$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/3fe2bb90-2e37-4162-a7ba-305224460eb2/image.png)

可由高阶开环传递函数画出 Bode 图，得出$$\omega_c$$并计算$$\gamma$$，查图可得$$\sigma\%$$和$$t_s$$，相较于主导极点估算时域性能指标的方法更便捷。

### 闭环频域特性曲线

手绘闭环频域特性曲线，用向量法先绘制等 M 圆图和等 N 圆图构成 Nichols 图，通过开环频域特性曲线逐点查图对应绘制闭环频域曲线

$$ \Phi(s) = \frac{G(j\omega)}{1 + G(j\omega)} = M(\omega)\cdot e^{j\phi(\omega)} $$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/ab248240-9e02-4821-b374-e1e074918837/image.png)

### 闭环频域指标

- 零频值$$M_0 = M(0)$$
- 谐振频率$$\omega_r$$，谐振峰值$$M_r$$
- 带宽频率$$\omega_b$$，$$M(\omega)$$下降到$$0.707M(0)$$对应的$$\omega$$

对欠阻尼二阶系统$$\Phi(s) = \frac{\omega_n^2}{s^2 + 2\xi\omega_ns + \omega_n^2}$$

$$ M_0 = 1\\ \omega_r = \omega_n\sqrt{1 - 2\xi^2}\\ M_r = \frac{1}{2\xi\sqrt{1 - \xi^2}}\\ t_s = \frac{3.5}{\xi\omega_n}\\ \omega_b = \omega_n\sqrt{1 - 2\xi^2 + \sqrt{2 - 4\xi^2 + 4\xi^4}}\\ \omega_b t_s = \frac{3.5}{\xi}\sqrt{1 - 2\xi^2 + \sqrt{2 - 4\xi^2 + 4\xi^4}} $$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/b5524f8e-4951-4523-afb8-aaeec5549bea/image.png)

同理，当$$\omega_n$$确定后，可以建立$$\xi$$与$$\omega_r$$、$$M_r$$、$$t_s$$、$$\omega_b$$、$$\sigma\%$$的一一对应关系。

对于高阶系统，同样有经验公式可以估算动态性能指标。$$(35\degree \le \gamma \le 90\degree)、(1 \le M_r \le 1.8)$$时精确程度较高

$$ \sigma\% = \left[ 0.16 + 0.4\left(M_r -1\right) \right]\times 100\%\\ t_s = \frac{\pi}{\omega_c}\left[ 2 + 1.5\left(M_r - 1\right) + 2.5 \left(M_r - 1\right)^2 \right]\\ M_r = \frac{1}{\sin\gamma} $$

### 频域校正

校正要有重点地照顾各项指标要求，不要追求不切实际的高指标。串联校正的设计过程需要不断检验性能指标是否满足给定指标的要求，是一个需要反复试错的过程。另外，频率法串联校正适用得到范围为单位反馈的最小相角系统，对于非最小相角相角系统，需将$$L(\omega)$$和$$\varphi(\omega)$$曲线同时绘出，在考虑稳定性的基础上进行校正。

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/147f6d27-bc57-40ee-87b0-c6108a1d320b/image.png)

串联超前校正

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/951da013-c2d9-4303-b385-bbad29e52a53/image.png)

$$ G_c'(s) = \frac{U_c(s)}{U_r(s)} = \frac{1}{a}\cdot\frac{aTs + 1}{Ts + 1} = \frac{1}{a}G_c(s) $$

其中$$T = \frac{R_1R_2C}{R_1 + R_2}$$，$$a = \frac{R_1 + R_2}{R_2} > 1$$

$$\frac{1}{a}$$是增益，后面增益为 1 的部分是标称

对于$$G_c(s)$$，$$\varphi(\omega) = \arctan\frac{aT\omega - T\omega}{1+aT^2\omega^2}$$

令$$\frac{\text{d}\varphi(\omega)}{\text{d}\omega} = 0$$得

$$ \omega_m = \frac{1}{\sqrt{aT}}\\ L(\omega_m) = 10\lg a\\ 最大超前角\varphi_m = \varphi(\omega_m) = \arctan\frac{a - 1}{2\sqrt{a}} = \arcsin\frac{a - 1}{a + 1}\\ a = \frac{1 + \sin \varphi_m}{1 - \sin \varphi_m} $$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/92b21407-07d1-4730-bba6-14918a51a69f/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/4f2aea95-7e62-4374-b19e-7c7ddce2a554/image.png)

串联超前校正的实质是利用超前网络相角超前特性提高系统的相角裕度，用于校正前系统$$\omega_{c0}、\gamma_0$$均不足时；校正效果为相角超前、幅值增大；可以保持低频段（满足稳态精度$$e^*_{ss}$$）、改善中频段（提高$$\omega_c、\gamma$$，改善动态性能）、抬高高频段（抗高频干扰能力降低）；一级超前校正$$\varphi_m$$最大为$$60\degree$$

校正步骤：

- 由$$e^*_{ss}$$求增益$$K$$
- 由$$G_0(s)$$求$$L_0(\omega)$$，得到$$\omega_{c0}、\gamma_0$$
- $$\varphi_m = \gamma^* - \gamma_0 + (5\degree - 10\degree)$$
- $$a = \frac{1 + \sin \varphi_m}{1 - \sin \varphi_m}$$，$$L(\omega_m) = 10\lg a$$
- 作出$$G_c(s)$$的 Bode 图，叠加得到校正后系统的 Bode 图，检查是否满足要求
- $$G(s) = G_c(s)\cdot G_0(s)$$，验算$$\omega_c、\gamma$$

串联滞后校正

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/9963126b-ec26-4be0-8b36-15ee807d5478/image.png)

$$ G_c(s) = \frac{U_c(s)}{U_r(s)} = \frac{bTs + 1}{Ts + 1} $$

其中$$T = (R_1 + R_2)C$$，$$b = \frac{R_2}{R_1 + R_2} < 1$$

对于$$G_c(s)$$，$$\varphi(\omega) = \arctan\frac{bT\omega - T\omega}{1+bT^2\omega^2}$$

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/f909cf9a-5364-424f-a232-31ef5fd03c05/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/519f7ae8-4ffb-4316-92c9-9643c2bb306f/image.png)

串联滞后校正的实质是利用滞后网络幅值衰减特性挖掘系统自身的相角储备，用于校正前系统$$\omega_{c0}$$已满足要求而$$\gamma_0$$均不足时；校正效果为相角滞后、幅值衰减；可以保持低频段（满足稳态精度$$e^*_{ss}$$）、降低中频段（降低$$\omega_c$$提高$$\gamma$$，损失快速性，改善均匀性）、压低高频段（抗高频干扰能力提高）

校正步骤：

- 由$$e^*_{ss}$$求增益$$K$$
- 由$$G_0(s)$$求$$L_0(\omega)$$，得到$$\omega_{c0}、\gamma_0$$
- $$\gamma_c = \gamma^* +6\degree$$，得到$$\omega_c$$
- $$a = \frac{1 + \sin \varphi_m}{1 - \sin \varphi_m}$$，$$L(\omega_m) = 10\lg a$$
- 作出$$G_c(s)$$的 Bode 图，叠加得到校正后系统的 Bode 图，检查是否满足要求
- $$G(s) = G_c(s)\cdot G_0(s)$$，验算$$\omega_c、\gamma$$

---

串联滞后-超前校正

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/e97cec30-dc3b-4393-97f5-5b049d34dcc5/image.png)

$$ G_c(s) = \frac{T_as + 1}{aT_as + 1}\cdot\frac{T_bs + 1}{\frac{T_b}{a}s + 1} $$

其中，前面部分为滞后部分，后面部分为超前部分，$$a > 1$$；串联超前滞后校正的实质为，综合利用之后网络幅值衰减和超前网络相角超前的特性，提高系统性能，用于单独用超前网络或滞后网络均无效时；校正效果为幅值衰减、相角超前。

校正步骤：

- 由$$e^*_{ss}$$求增益$$K$$
- 由$$G_0(s)$$求$$L_0(\omega)$$，得到$$\omega_{c0}、\gamma_0$$
- $$\varphi_m = \gamma^* - \gamma_0(\omega_c) + 6\degree$$
- $$a = \frac{1 + \sin \varphi_m}{1 - \sin \varphi_m}$$
- 作出$$G_c(s)$$的 Bode 图，叠加得到校正后系统的 Bode 图，检查是否满足要求
- $$G(s) = G_c(s)\cdot G_0(s)$$，验算$$\omega_c、\gamma$$

---

串联 PID 校正

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/5961c4e9-7f04-42a9-8b1f-79923b32d316/image.png)

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c93b1fd6-9688-4461-b49f-c173152581d4/c8829c9a-215c-421e-af79-9edfafdbc09f/image.png)

$$ G_c(s) = K_p + \frac{K_I}{s} + K_Ds = \frac{K_I(T_1s + 1)(T_2s + 1)}{s} $$
