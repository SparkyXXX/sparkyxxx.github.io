---
title: 3DGS原理
description: 3DGS前置知识
author: Hatrix
date: 2025-07-09 17:18:00 +0800
categories: [知识储备]
tags: [计算机视觉，计算机图形学]
math: true
mermaid: true
pin: false
image:
  path: https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/SuperSplat-image.png
  alt: 3DGS基础
---

## 概述

> 什么是 3DGS？3DGS 是如何实现三维重建的？

3DGS 是基于 Splatting 和机器学习的三维重建方法。根据多视角图像，从 SfM 生成的点云和相机参数矩阵出发，将点膨胀成带有一系列参数的高斯椭球，并以此为基本单位来表示场景。为了实现对三维场景的高质量表达，3DGS 通过深度学习的方式优化高斯椭球的参数。具体来说，是将用高斯椭球表示的三维场景按照给定的视角投影到二维平面得到渲染图像，渲染图像与真值图像作 loss，反向传播到各个可学习参数上完成优化。

## 初始化

> SfM 是什么？点云是什么？相机矩阵是什么？如何初始化？

SfM(Structure from Motion，运动恢复结构)是一种从多张图像中恢复三维结构和相机运动的计算机视觉技术，通过特征点匹配和对极约束的纯几何方法，估计每张图像对应的相机姿态和各个特征点在三维中的位置，并进行多视图几何优化(联合优化所有相机和 3D 点坐标)。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250722090718791.png)

点云是 SfM 技术恢复出的三维结构的表达方式，可视为三维曲面的离散化样本。点云共同组成了物体和环境的轮廓，可以包含三维坐标、RGB、语义标签、时间戳等丰富信息。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250628160700429.png)

相机矩阵是根据真实相机成像过程抽象出的数学模型，用于实现从三维场景到二维渲染图像的转换。相机矩阵分为内参矩阵和外参矩阵，内参矩阵包含了焦距、主点偏移、畸变系数等；外参矩阵包含了相机的位置和姿态信息。

外参矩阵

$$
\begin{bmatrix}
\mathbf{R} & \mathbf{t} \\
\mathbf{0} & 1
\end{bmatrix}=
\begin{bmatrix}
\mathbf{I} & \mathbf{t} \\
\mathbf{0} & 1
\end{bmatrix}
\times
\begin{bmatrix}
\mathbf{R} & \mathbf{0} \\
\mathbf{0} & 1
\end{bmatrix}=
\begin{bmatrix}
1 & 0 & 0 & t_1 \\
0 & 1 & 0 & t_2 \\
0 & 0 & 1 & t_3 \\
0 & 0 & 0 & 1
\end{bmatrix}
\times
\begin{bmatrix}
r_{1,1} & r_{1,2} & r_{1,3} & 0 \\
r_{2,1} & r_{2,2} & r_{2,3} & 0 \\
r_{3,1} & r_{3,2} & r_{3,3} & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

内参矩阵

$$
\begin{bmatrix}
f_x&0&c_x\\
0&f_y&c_y\\
0&0&1
\end{bmatrix}
$$

## 三维高斯表示

> 高斯椭球是什么？为何可以表示场景？

高斯椭球是一个带有位置、形状、颜色和不透明度的椭球，其中位置和形状分别由三维高斯分布中的均值和协方差矩阵确定，颜色由球谐函数确定。球谐函数是球坐标系中将函数值与方位角度产生联系的函数，3DGS 中以此实现不同视角下观察到不同颜色的效果。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250716221739430.png)

这样的高斯椭球，是一种连续可微的体素表示(体素是计算机图形学中，三维空间的基本组成单位)。通过足够多的高斯覆盖场景，整个空间是无数个半透明彩色“雾球”(高斯)叠在一起的结果。每个雾球有方向、有颜色、有形状、有透明度。你从一个角度看过去，看到的是这些雾球的混合结果，就能看到场景的样子。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250716211520548.png)

## 渲染过程

> 如何将三维椭球按给定视角投影到二维平面？投影之后的二维高斯椭圆如何组成图像？

### 投影过程

在 3DGS 中，这个从三维场景到二维图像的渲染过程称为光栅化。总体来说，光栅化将每个 3D 高斯投影到 2D 屏幕上，并按深度顺序将其颜色和透明度累加到对应像素，生成最终图像。

3D 高斯椭球的投影具体来说可以细分为四个过程：观测变换、投影变换、视口变换、像素离散。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250710192219269.png)

观测变换是从世界坐标系转换到相机坐标系的过程，本质上是旋转、缩放和平移三种变换的组合。

投影变换是从相机坐标系转换到图像平面的过程，先将视锥通过非线性变换化为正交空间，然后变换到归一化立的立方体空间内，最后正交投影忽略深度便转化到二维图像平面。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250710191537752.png)

视口变换是将投影得到的归一化平面还原到符合图像长宽的图像坐标系的过程，即将$$[-1, 1]^2$$的矩形还原到$$[0, w] \times [0, h]$$。

像素离散是将连续图像坐标系离散采样到像素坐标系的过程，根据像素中心点是否在图像中决定是否渲染该像素。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250710212143946.png)

### 合成过程

图像合成采用$$\alpha$$-blending 的方法，对于每一个区块，将高斯椭球按深度从近到远排序，由近到远遍历每个高斯椭球来填充像素的不透明度，直到该区块内所有像素的$$\alpha=1$$(完全不透明)为止；若混合完所有高斯椭球仍未达到$$\alpha=1$$则用背景颜色填充剩余不透明度。

![](https://cdn.jsdelivr.net/gh/SparkyXXX/Hatrix-s-Blog-Image/img/20250716225926493.png)

## 参数优化

通过以上步骤，可以获得给定视角下的渲染图像，与真值图像作 loss 之后，经过反向传播和梯度下降便可逐步调整高斯椭球的各个参数，使得渲染图像越发接近真值图像，从而完成对整个场景的重建。

3DGS 中，这个损失函数如下，其中$$L_1$$项代表逐像素绝对误差，而 D-SSIM 是一种衡量两张图像结构相似度的感知指标，考虑了亮度、对比度和结构信息，相应地，这项损失代表了图像整体结构上的误差。

$$
L = (1-\lambda)L_1 + \lambda L_{D-SSIM}，\lambda=0.2
$$

## 补丁和工程 tricks

分图块以并行训练、自适应密度控制
