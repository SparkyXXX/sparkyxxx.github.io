---
title: 微积分
description: 课程笔记
author: Hatrix
date: 2024-09-10 16:57:00 +0800
categories: [基础数学]
tags: [课程笔记]
math: true
mermaid: true
---

## 第一章 函数

### 1.1 集合

集合是某些确定对象的整体，具有确定性、无序性和互异性，有列举法和描述法两种表示方式。

元素与集合的关系是属于(记作 ∈)或不属于(记作 ∉)。集合与集合之间的关系主要有子集关系和相等关系两种。集合之间的常见运算有交并查补四种。

![image-20250302220035864](../assets/post-pics/image-20250302220035864.png)

### 1.2 邻域

区间是实数集合中的一个子集，表示某个范围内的所有实数。根据端点是否包含在区间中，区间可以分为开区间、闭区间、半开半闭区间和无限区间。多元函数中对应的概念为区域，分为开区域和闭区域。

一维的邻域定义为：对于一个实数 $$x$$ 和一个正数 $$\varepsilon > 0$$，称实数$$x$$的一个邻域为包含$$x$$ 的开区间$$(x - \varepsilon, x + \varepsilon)$$ ，即所有与$$x$$的距离小于 $$\varepsilon$$的点的集合

$$
U(x_\text{0}, \delta) = \{ x \in \mathbb{R} \ | \ |x - x_\text{0}| < \delta \}
$$

高维的邻域定义为：设$$P_\text{0}(x_\text{0},y_\text{0})$$是平面上的一个点，$$\delta$$是某一正数，与点$$P_\text{0}(x_\text{0},y_\text{0})$$距离小于$$\delta$$的点$$P(x,y)$$的全体称为点$$P_\text{0}$$的$$\delta$$邻域

$$
U(P_\text{0},\delta)=\{P\mid |PP_\text{0}|<\delta\}
$$

### 1.3 映射

设有两个集合$$A$$和$$B$$，从$$A$$到$$B$$的一个规则$$f$$，把$$A$$中的每个元素$$x$$唯一地关联到$$B$$中的一个元素，这样的$$f$$称为映射，记为

$$
f:A \rightarrow B
$$

其中$$A$$称为原像，$$B$$称为像。如果不同输入永远映射到不同输出，称为单射；如果$$B$$中的每一个值都有至少一个输入可以通过该映射得到，称为满射；既是单射又是满射称为双射，双射即一一对应。

### 1.4 函数

设$$D$$为非空数集，称映射$$f：D \rightarrow f(D)$$称为定义在 D 上的一元函数；多元函数类似：设$$ D $$是$$ n $$维空间$$\mathbb{R}^n$$中的一个非空子集，称映射$$f:D\to\mathbb{R}$$为定义在 D 上的$$ n $$元函数。若$$f$$为双射，则存在逆映射$$f^{-1}(D)\rightarrow D$$，对应的函数叫反函数。将函数嵌套就得到了复合函数，如$$y = f[g(x)]$$。当函数在整个定义域上没有统一表达式时，可用分段函数的形式表达。

常数函数、幂函数、指数函数、对数函数、三角函数、反三角函数统称为基本初等函数，由基本初等函数经过有限次四则运算、复合、求逆构成的函数称为初等函数，可以用一个式子表示。多元多项式及基本初等函数进行有限次四则运算、复合、求逆构成的函数称为多元初等函数，多元初等函数在定义域内是连续的

![image-20250302220053957](../assets/post-pics/image-20250302220053957.png)

#### 三角函数和双曲函数

三角函数和双曲函数涉及较多实用性质，单独整理出来

- 定义：三角函数是定义在单位圆上的，参数双曲函数是定义在单位等轴双曲线上的。双曲函数和三角函数在复平面上仅仅差一个正交旋转。

  ![image-20250323152050507](../assets/post-pics/image-20250323152050507.png)

- 函数图像

  ![image-20250323151928382](../assets/post-pics/image-20250323151928382.png)

- 常用公式

  ![image-20250323152516057](../assets/post-pics/image-20250323152516057.png)

### 1.5 参数方程

用一个或多个参数来描述曲线或曲面，以一种动态轨迹的视角表示曲线或曲面上的每一个点，以下是常见的参数方程

$$
\begin{aligned}
&\left\{ \begin{aligned} x &= r \cos t \\ y &= r \sin t \end{aligned} \right. \quad r 是半径，t 是参数范围 \quad &圆\\
&\left\{ \begin{aligned} x &= a \cos t \\ y &= b \sin t \end{aligned} \right. \quad a和b分别为长轴和短轴， t是参数范围 \quad &椭圆\\
&\left\{ \begin{aligned} x &= r \cos t \\ y &= r \sin t \\ z &= c t \end{aligned} \right. \quad r 是半径，c 控制 z 方向的变化， t 是参数范围 \quad &螺旋线\\
&\left\{ \begin{aligned} x &= r (t - \sin t) \\ y &= r (1 - \cos t) \end{aligned} \right. \quad r 是圆的半径， t 是参数范围 \quad &摆线/最速降线\\
&\left\{ \begin{aligned} x &= r \cos t \\ y &= r \sin t \\ z &= z \end{aligned} \right. \quad r是圆柱的半径，t是参数，z可以取任意值 \quad &圆柱面
\end{aligned}
$$

### 1.6 极坐标系

极坐标系使用极径(到原点的距离)和极角(与 x 轴正方向的夹角)来描述曲线，是相对于笛卡尔平面直角坐标系的二维坐标系。对于具有旋转对称性或以圆形为基础的几何图形，在极坐标系中能够通过简单的函数更自然地表达出来。

与直角坐标系的转化关系

$$
\begin{aligned}
&\left\{ \begin{aligned} x &= r \cdot cos \theta \\ y &= r \cdot \sin \theta \end{aligned} \right.  \quad &从极坐标转化为直角坐标\\
&\left\{\begin{aligned} r &= \sqrt{x^2 + y^2} \\ \theta &= \text{atan2}(y, x) \end{aligned} \right. \quad &从直角坐标转化为极坐标
\end{aligned}
$$

常见的极坐标方程

$$
\begin{aligned}
&r = R \quad &圆\\
&r = a + b\theta &阿基米德螺线\\
&r = a(1 + \cos\theta) &心形线\\
&r^2 = a^2 \cos(2\theta) &双纽线\\
\end{aligned}
$$

### 1.7 空间解析几何相关

由于后续的多元微积分配合一些空间解析几何的知识会更有助于理解，此处单独开一小节补充记录。

对集合中的元素定义加和数乘以及交换律结合律分配律，零向量负向量单位元，就得到向量空间；在向量空间中定义内积就得到欧几里得空间，此处的讨论均基于三维欧氏空间。基本的概念和度量包括

- 坐标：一组基下的表示系数，同样的点在不同基下的坐标可能不同，可以通过基变换相互转化

- 投影：一种降维的映射，矩阵在其列空间上的投影矩阵为$$P = A(A^TA)^{-1}A^T$$

- 距离：点到点、点到线、点到面、平行线之间、不共面的线之间、平行面之间，都有相应的计算公式

- 夹角：共面直线之间、线与面之间、面与面之间，都有相应的计算公式

- 数量积/内积：衡量向量间的相似程度

  $$
  \vec{a}\cdot\vec{b}=a_{x}b_{x} + a_{y}b_{y} + a_{z}b_{z}
  $$

- 向量积/外积：衡量向量间的垂直程度

  $$
  \begin{aligned}
  \vec{c} &= \vec{a}\times\vec{b}=
  \begin{vmatrix}
  \vec{i} & \vec{j} & \vec{k} \\
  a_{x} & a_{y} & a_{z} \\
  b_{x} & b_{y} & b_{z}
  \end{vmatrix}
  =
  \vec{i}(a_{y}b_{z} - a_{z}b_{y}) - \vec{j}(a_{x}b_{z} - a_{z}b_{x}) + \vec{k}(a_{x}b_{y} - a_{y}b_{x})\\
  |c| &= |a||b|\sin \theta\quad方向符合右手螺旋
  \end{aligned}
  $$

- 混合积：表示三个向量张成的平行六面体体积
  $$
  [\vec{a},\vec{b},\vec{c}]= (\vec{a}\times\vec{b})\cdot\vec{c}=
  \begin{vmatrix}
  a_{x} & a_{y} & a_{z} \\
  b_{x} & b_{y} & b_{z} \\
  c_{x} & c_{y} & c_{z}
  \end{vmatrix}
  = a_{x}\begin{vmatrix}
  b_{y} & b_{z} \\
  c_{y} & c_{z}
  \end{vmatrix} - a_{y}\begin{vmatrix}
  b_{x} & b_{z} \\
  c_{x} & c_{z}
  \end{vmatrix} + a_{z}\begin{vmatrix}
  b_{x} & b_{y} \\
  c_{x} & c_{y}
  \end{vmatrix}
  $$

通过同一个点的直线构成直线系、通过同一条直线的平面构成平面束。

平面方程有以下几种表达方式：

$$
\begin{aligned}
&A(x - x_\text{0})+B(y - y_\text{0})+C(z - z_\text{0})=0\quad &点法式\\
&\begin{vmatrix}
x - x_\text{1} & y - y_\text{1} & z - z_\text{1} \\
x_\text{2} - x_\text{1} & y_\text{2} - y_\text{1} & z_\text{2} - z_\text{1} \\
x_\text{3} - x_\text{1} & y_\text{3} - y_\text{1} & z_\text{3} - z_\text{1}
\end{vmatrix}=0 \quad &三点式\\
&Ax + By + Cz + D = 0\quad &一般式\\
&\frac{x}{a}+\frac{y}{b}+\frac{z}{c}=1 \quad &截距式
\end{aligned}
$$

直线方程有以下几种表达方式

$$
\begin{aligned}
&\frac{x - x_\text{0}}{m}=\frac{y - y_\text{0}}{n}=\frac{z - z_\text{0}}{p}\quad &对称式\\
&\frac{x - x_\text{1}}{x_\text{2} - x_\text{1}}=\frac{y - y_\text{1}}{y_\text{2} - y_\text{1}}=\frac{z - z_\text{1}}{z_\text{2} - z_\text{1}}\quad &两点式\\
&\begin{cases}A_\text{1}x + B_\text{1}y + C_\text{1}z+D_\text{1} = 0\\A_\text{2}x + B_\text{2}y + C_\text{2}z+D_\text{2} = 0\end{cases}\quad &一般式\\
&\begin{cases}x = x_\text{0}+mt\\y = y_\text{0}+nt\\z = z_\text{0}+pt\end{cases}\quad &参数式
\end{aligned}
$$

常见的二次曲面方程如下

$$
\begin{aligned}
&\frac{x^2}{a^2}+\frac{y^2}{b^2}+\frac{z^2}{c^2}=1\quad &椭球面\\
&z=\frac{x^2}{a^2}+\frac{y^2}{b^2}\quad &椭圆抛物面\\
&z=\frac{x^2}{a^2}-\frac{y^2}{b^2}\quad &双曲抛物面\\
&\frac{x^2}{a^2}+\frac{y^2}{b^2}-\frac{z^2}{c^2}=1\quad &单叶双曲面\\
&\frac{x^2}{a^2}-\frac{y^2}{b^2}-\frac{z^2}{c^2}=1\quad &双叶双曲面\\
&\frac{x^2}{a^2}+\frac{y^2}{b^2}-\frac{z^2}{c^2}=0\quad &椭圆锥面\\
&(x - x_\text{0})^2+(y - y_\text{0})^2+(z - z_\text{0})^2 = R^2\quad &球面\\
&F(x,y)=0(母线平行于z轴)\quad &柱面\\
&(\sqrt{x^2 + y^2}-a)^2+z^2 = b^2\quad &环面
\end{aligned}
$$

![image-20250323083545972](../assets/post-pics/image-20250323083545972.png)

空间曲线切线和法平面、空间曲面切平面和法线方程如下：

$$
\begin{aligned}
&\frac{x - x_\text{0}}{x^{\prime}(t_\text{0})}=\frac{y - y_\text{0}}{y^{\prime}(t_\text{0})}=\frac{z - z_\text{0}}{z^{\prime}(t_\text{0})} \quad &\text{空间曲线切线方程}\\
&x^{\prime}(t_\text{0})(x - x_\text{0})+y^{\prime}(t_\text{0})(y - y_\text{0})+z^{\prime}(t_\text{0})(z - z_\text{0})=0 \quad &\text{空间曲线法平面方程}\\
&f_{x}'(x - x_\text{0})+f_{y}'(y - y_\text{0})+(-1)(z - z_\text{0})=0 \quad &\text{空间曲面切平面方程}\\
&\frac{x - x_\text{0}}{f_{x}'}=\frac{y - y_\text{0}}{f_{y}'}=\frac{z - z_\text{0}}{-1} \quad &\text{空间曲面法线方程}
\end{aligned}
$$

## 第二章 极限

极限分为数列极限和函数极限，此处介绍函数极限，数列极限类似。

### 2.1 定义

一元函数极限定义为：设$$f(x)$$是定义在某个开区间(去掉 $$x_\text{0}$$点)上的函数。如果存在实数$$L$$，使得对于任意的正数$$\varepsilon > 0$$，总存在一个正数$$\delta > 0$$，当$$0 < \vert x - x_\text{0} \vert < \delta$$时，函数值 $$f(x)$$满足$$\vert f(x) - L \vert < \varepsilon$$，则称$$L$$是函数 $$f(x)$$在$$x_\text{0}$$处的极限，表示如下，其中$$x_\text{0}$$亦可代入$$\infty$$。另外，若极限为$$\infty$$，习惯上写成$$\lim_x \to x_\text{0} f(x) = \infty$$，但此时极限不存在。

$$
\lim_x \to x_\text{0} f(x) = L
$$

根据$$x$$的趋近方向，有左极限和右极限之分，左右极限均存在且相等，这一点的极限才存在。

多元函数极限定义为：设$$ n $$元函数$$f(P)$$在点$$P*\text{0}$$的某一去心邻域内有定义，如果存在常数$$ L$$，对于任意给定的正数$$\varepsilon$$，总存在正数$$\delta$$，使得当点$$ P $$满足$$0 < \vert PP*\text{0}\vert < \delta$$时，都有$$\vert f(P) - L\vert < \varepsilon$$成立，那么就称常数$$ L $$为函数$$f(P)$$当$$P\to P\_\text{0}$$时的极限，表示如下

$$
\lim_{P\to P_\text{0}}f(P)=L
$$

### 2.2 存在性定理

- 单调递增且有上界或单调递减且有下界，则极限存在

- 夹逼准则：设函数$$f(x)、g(x)、h(x)$$在某个开区间$$I$$(区间覆盖点$$x_\text{0}$$，但不一定包含$$x_\text{0}$$本身)内满足$$g(x) \leqslant f(x) \leqslant h(x)$$。对于所有$$x \in I \setminus \{x_\text{0}\}$$($$\setminus$$是集合差运算的符号)

  如果：

  $$
  \lim_{x \to x_\text{0}} g(x) = \lim_{x \to x_\text{0}} h(x) = L
  $$

  则有：

  $$
  \lim_{x \to x_\text{0}} f(x) = L
  $$

### 2.3 性质

- 有界性：极限收敛的函数必有界
- 唯一性：极限存在则唯一
- 运算法则：若函数的极限存在且为有限值，则极限满足普遍意义上的四则运算、常数倍、幂函数和复合函数运算法则。

### 2.4 无穷小和无穷大

极限为$$ 0 $$即为无穷小，极限为$$\infty$$即为无穷大(此时极限不存在)，两者互为倒数。

无穷小有阶数之分，设$$\alpha$$，$$\beta$$为同一趋近过程中的两个无穷小，且$$\alpha \neq 0$$

- 若$$\lim\frac{\beta}{\alpha} = 0$$，则$$\beta$$为$$\alpha$$的高阶无穷小，记为$$\beta = o(\alpha)$$

- 若$$\lim\frac{\beta}{\alpha} = C \neq 0$$，则$$\beta、\alpha$$为同阶无穷小

  当$$C = 1$$时，称为等价无穷小，记为$$\alpha$$~$$\beta$$；等价无穷小之间可以进行代换以方便一些运算。

当$$x \to 0$$时，常用的等价无穷小如下

| $$\sin x$$ ~ $$x$$ | $$\arcsin x$$ ~ $$x$$ | $$1 - \cos x$$ ~ $$\frac{1}{2}x^2$$ |
| $$\tan x$$ ~ $$x$$ | $$\arctan x$$ ~ $$x$$ | $$a^x - 1$$ ~ $$x \ln a$$ |
| $$\ln (1 + x)$$ ~ $$x$$ | $$\text{e}^x - 1$$ ~ $$x$$ | $$\sqrt{1 + x} - 1$$ ~ $$\frac{1}{2}x$$ |

无穷小运算法则

1. 同一趋近过程的有限个无穷小之和为无穷小

2. 局部有界函数 $$\times$$ 无穷小为无穷小

3. 高阶无穷小运算法则
   $$
   \begin{aligned}
        &o(x^m) \pm o(x^n) = o(x^l), l = \min\{ m, n\}\\
        &o(x^m) \cdot o(x^n) = o(x^{m+n})\\
        &\frac{o(x^m)}{x^n} = o(x^{m - n})\\
        &o(kx^n) = o(x^n), k \neq 0\\
    \end{aligned}
   $$

### 2.5 洛必达法则

在满足一定条件的前提下，用于求解未定式的极限。未定式是指，$$x \to a$$时，$$f(x),g(x)$$均$$\to 0$$或均$$\to \infty$$，$$\lim_{x \to a}\frac{f(x)}{g(x)}$$可能存在也可能不存在，这个式子称为未定式。法则的内容为，在满足以下三个条件时，有$$\lim_{x \to a}\frac{f(x)}{g(x)} = \lim_{x \to a} \frac{f'(x)}{g'(x)}$$

1. $$x \to a$$时，$$f(x)，g(x)$$均$$\to 0$$或均$$\to \infty$$
2. 在$$x \in \mathring{U}(a, \delta)$$内，$$f'(x)，g'(x)$$均存在且$$g'(x) \neq 0$$
3. $$\lim_{x \to a} \frac{f'(x)}{g'(x)}$$存在或为无穷大

### 2.6 几个重要极限

$$
\begin{aligned}
\lim_{x \to 0} \frac{\sin(x)}{x} &= 1 \\
\lim_{x \to \infty} \frac{x^\alpha}{\text{e}^x} &= 0 \\
\lim_{x \to \infty} \frac{\ln x}{x^\alpha} &= 0 \\
\lim_{x \to \infty} \left( 1 + \frac{1}{x} \right)^x &= \text{e}
\end{aligned}
$$

## 第三章 导数

### 3.1 连续与间断点

连续的前提是该点极限存在

一元函数连续的定义为：设函数$$f(x)$$ 在$$U(x_\text{0},\delta)$$内有定义，若$$\lim_{x \to x_\text{0}} f(x) = f(x_\text{0})$$或$$\lim_{\Delta x \to 0} \Delta y = 0$$，则$$f(x)$$在$$x_\text{0}$$处连续。

二元函数连续的定义为：函数$$f(x, y)$$在$$P_\text{0}$$的某去心邻域内有定义，若$$\lim_{x \to x_\text{0}, y \to y_\text{0}}f(x, y) = f(x_\text{0},y_\text{0})$$，或$$\lim_{\Delta x \to 0, \Delta y \to 0} \Delta z =  \lim_{\Delta x \to 0, \Delta y \to 0} f(x_\text{0} + \Delta x， y_\text{0} + \Delta y) - f(x_\text{0}, y_\text{0}) = 0$$，则$$f(x, y)$$在$$P_\text{0}$$处连续。

- 根据趋近方向，一元函数的连续分为左连续和右连续，一元函数在某一点连续等价于在该点左连续且右连续。
- 一元函数若在区间上每一点都连续，则在区间上连续。
- 若二元函数$$f(x, y)$$在$$(x_\text{0}, y_\text{0})$$处连续，则一元函数$$f(x, y_\text{0})，f(x_\text{0}, y)$$分别在$$x_\text{0}，y_\text{0}$$处连续。
- 边界点上的连续：若$$P_\text{0}$$为边界点，任意$$P \in D$$以任意方式趋于$$P_\text{0}$$时，满足上述定义中的条件，则称$$f(x, y)$$在$$P_\text{0}$$处有条件连续。
- 若$$f(x, y)$$在开区域$$D$$中任意点均连续，则称函数在开区域上连续；开区域连续+边界有条件连续=闭区域连续。闭区域上连续的函数满足有界性、最值定理、介值定理、零点存在定理。

函数连续的性质满足一般意义上的四则运算、反函数、符合函数规则

不连续的点称为间断点，一元函数的间断点分为两类

- 第一类间断点：左右极限都存在。若左右极限相等，称为可去间断点(不连续的原因是$$x_\text{0}$$处无定义)，若左右极限不相等，则称为跳跃间断点
- 第二类间断点：左右极限至少有一个不存在。若其中有一个极限为$$\infty$$，称为无穷间断点；否则为振荡间断点。

### 3.2 定义

#### 一元函数导数

设$$f(x)$$在$$x_\text{0}$$的某邻域有定义且在$$x_\text{0}$$处连续，若$$\lim_{x \to x_\text{0}}\frac{f(x) - f(x_\text{0})}{x - x_\text{0}}$$存在，则称$$f(x)$$在$$x_\text{0}$$处可导，称该值为$$f(x)$$在$$x_\text{0}$$处的导数，记为$$f'(x_\text{0})$$。类似地可定义高阶导数。一阶导数反映了曲线在该点的切线斜率。

根据趋近方向，分为左导数和右导数。可导等价于左导数右导数均存在且相等。

若$$f(x)$$在开区间$$I$$内每一点均可导，则称$$f(x)$$在$$I$$上可导，此时由导数值构成的函数称为导函数。

#### 多元函数偏导数

设函数$$z = f(x,y)$$在点$$(x_\text{0},y_\text{0})$$的某一邻域内有定义，若极限$$\lim_{\Delta x\to0}\frac{f(x_\text{0}+\Delta x,y_\text{0})-f(x_\text{0},y_\text{0})}{\Delta x}$$存在，则称该值为函数$$z = f(x,y)$$在点$$(x_\text{0},y_\text{0})$$处对$$x$$的偏导数，记作$$f_{x}(x_\text{0},y_\text{0})$$，$$\frac{\partial z}{\partial x}\vert_{(x_\text{0},y_\text{0})}$$，$$\frac{\partial f}{\partial x}\vert_{(x_\text{0},y_\text{0})}$$或$$z_{x}\vert_{(x_\text{0},y_\text{0})}$$。对$$y$$的偏导数类似。二元函数中，求偏导数相当于在函数的两个方向上求切线斜率。

高阶偏导数有纯偏导($$\frac{\partial^2 z}{\partial x^2}$$、$$\frac{\partial^2 z}{\partial y^2}$$)和混合偏导($$\frac{\partial^2 z}{\partial x \partial y}$$、$$\frac{\partial^2 z}{\partial y \partial x}$$)，当二阶偏导数连续时，两个混合偏导相等。

#### 多元函数方向导数

设函数$$z = f(x,y)$$在点$$P(x_\text{0},y_\text{0})$$的某一邻域$$U(P)$$内有定义，自点$$ P $$引射线$$l$$，设$$ x $$轴正向到射线的转角为$$\varphi$$，在射线上取一点$$P'(x*\text{0} + \Delta x, y*\text{0} + \Delta y) \in U(P)$$，记$$\rho=\sqrt{(\Delta x)^2 + (\Delta y)^2}$$。如果极限

$$
\lim_{\rho \to 0}\frac{f(x_\text{0} + \Delta x,y_\text{0} + \Delta y)-f(x_\text{0},y_\text{0})}{\rho}
$$

存在，则称此极限为函数$$f(x,y)$$在点$$ P $$沿方向$$ l $$的方向导数，记作$$\frac{\partial f}{\partial l}\vert{(x*\text{0},y*\text{0})}$$。

若函数$$z = f(x,y)$$在点$$(x,y)$$可微，那么函数在该点沿任意方向的方向导数都存在，且有

$$
\frac{\partial f}{\partial l}=\frac{\partial f}{\partial x}\cos\varphi+\frac{\partial f}{\partial y}\sin\varphi
$$

方向导数刻画了函数在某一点沿着某一方向的变化率。

#### 梯度

梯度和方向导数联系紧密，梯度常用来表示物理量在空间中的变化趋势(如温度场、电场等)，此处一并整理。设函数$$z = f(x,y)$$在平面区域$$ D $$内具有一阶连续偏导数，则对于每一点$$P(x,y)\in D$$，都可确定一个向量$$\frac{\partial f}{\partial x}\vec{i}+\frac{\partial f}{\partial y}\vec{j}$$，这个向量称为函数$$f(x,y)$$在点$$P(x,y)$$的梯度，记作$$\nabla f(x,y)$$或$$\text{grad} f(x,y)$$

$$
\nabla f(x,y)=\frac{\partial f}{\partial x}\vec{i}+\frac{\partial f}{\partial y}\vec{j}
$$

梯度的方向是函数在该点处方向导数取得最大值的方向；梯度的模$$\vert\nabla f(x,y)\vert=\sqrt{(\frac{\partial f}{\partial x})^2 + (\frac{\partial f}{\partial y})^2}$$就是函数在该点的最大方向导数的值。

### 3.3 计算

- 四则运算

$$
\begin{aligned}
(f(x) + g(x))' &= f'(x) + g'(x)\\
(f(x) - g(x))' &= f'(x) - g'(x)\\
(f(x) \cdot g(x))' &= f'(x) \cdot g(x) + f(x) \cdot g'(x)\\
\left( \frac{f(x)}{g(x)} \right)' &= \frac{f'(x) \cdot g(x) - f(x) \cdot g'(x)}{g(x)^2}
\end{aligned}
$$

- 反函数：反函数导数为原函数导数的倒数

$$
(f^{-1}(x))' = \frac{1}{f'(x)}
$$

- 参数方程

$$
\begin{aligned}
&\left\{ \begin{aligned} x &= \phi(t) \\ y &= \psi(t) \end{aligned} \right.\\
&\frac{\text{d}y}{\text{d}x} = \frac{\text{d}y}{\text{d}t} \cdot \frac{\text{d}t}{\text{d}x} = \frac{\psi'(t)}{\phi'(t)}\\
&\frac{\text{d}^2 y}{\text{d}x^2} = \frac{\text{d}}{\text{d}x} \left( \frac{\text{d}y}{\text{d}x} \right) = \frac{\text{d}}{\text{d}x} \left( \frac{\psi'(t)}{\phi'(t)} \right) = \frac{\text{d}}{\text{d}t}\left( \frac{\psi'(t)}{\phi'(t)} \right) \cdot \frac{\text{d}t}{\text{d}x}\\
\end{aligned}
$$

- 极坐标：在$$\rho = \rho(\theta)$$的基础上，化为$$x,y$$关于$$\theta$$的参数方程
- 常用公式(三角函数和双曲函数部分见第一章 1.4 函数部分)

$$
\begin{aligned}
\frac{\text{d}}{\text{d}x} (c) &= 0  \\
\frac{\text{d}}{\text{d}x} (x^n) &= n x^{n-1}  \\
\frac{\text{d}}{\text{d}x} (\text{e}^x) &= \text{e}^x  \\
\frac{\text{d}}{\text{d}x} (\ln x) &= \frac{1}{x}  \\
\frac{\text{d}}{\text{d}x} (\log_{a} x) &= \frac{1}{x \ln a}
\end{aligned}
$$

$$
\begin{aligned}
\frac{\text{d}^n}{\text{d}x^n} (x^m) &= \frac{m!}{(m-n)!} x^{m-n}, \quad \text{当 } m \geqslant n \text{ 时}  \\
\frac{\text{d}^n}{\text{d}x^n} (x^m) &= 0, \quad \text{当 } m < n \text{ 时}  \\
\frac{\text{d}^n}{\text{d}x^n} (\text{e}^x) &= \text{e}^x  \\
\frac{\text{d}^n}{\text{d}x^n} (\ln x) &= (-1)^{n-1} \frac{(n-1)!}{x^n}  \\
\frac{\text{d}^n}{\text{d}x^n} \left( \frac{1}{x} \right) &= (-1)^n \frac{n!}{x^{n+1}}  \\
\frac{\text{d}^n}{\text{d}x^n} \left( \frac{1}{x \pm 1} \right) &= (-1)^n \frac{n!}{(x \pm 1)^{n+1}}  \\
\frac{\text{d}^n}{\text{d}x^n} \left( \frac{1}{1 - x} \right) &= n! \frac{1}{(1 - x)^{n+1}}  \\
\frac{\text{d}^n}{\text{d}x^n} (a^x) &= (\ln a)^n a^x  \\
\frac{\text{d}^n}{\text{d}x^n} (\sin x) &= \sin\left(x + \frac{n\pi}{2}\right)  \\
\frac{\text{d}^n}{\text{d}x^n} (\cos x) &= \cos\left(x + \frac{n\pi}{2}\right)
\end{aligned}
$$

#### 复合函数

链式法则

- 一元函数：设$$y = f(u)$$，$$u = g(x)$$，且$$g(x)$$在$$ x $$处可导，$$f(u)$$在对应的$$u = g(x)$$处可导，则复合函数$$y = f(g(x))$$在$$ x $$处可导
  $$
  y^\prime = f^\prime(g(x))\cdot g^\prime(x)
  $$
- 多元函数：设$$z = f(u,v)$$，$$u = \varphi(x,y)$$，$$v = \psi(x,y)$$，如果$$\varphi(x,y)$$和$$\psi(x,y)$$在点$$(x,y)$$处可微，$$f(u,v)$$在对应的点$$(u,v)$$处可微，则复合函数$$z = f(\varphi(x,y),\psi(x,y))$$在点$$(x,y)$$处可微
  $$
  \begin{cases}
  \frac{\partial z}{\partial x}=\frac{\partial f}{\partial u}\frac{\partial u}{\partial x}+\frac{\partial f}{\partial v}\frac{\partial v}{\partial x}\\
  \frac{\partial z}{\partial y}=\frac{\partial f}{\partial u}\frac{\partial u}{\partial y}+\frac{\partial f}{\partial v}\frac{\partial v}{\partial y}
  \end{cases}
  $$

#### 隐函数

无论一元还是多元，对等式两边同时对自变量求导再整理即可。对多元函数，将规律总结为隐函数的微分法则，可根据固定的公式计算多元函数的任意阶导数，以二元函数和三元函数为例

- 二元函数，一个方程：设$$F(x,y)$$在某区域内具有连续的偏导数$$F_{x}$$和$$F_{y}$$，且$$F_{y}\neq0$$，则

  $$
  y'=\frac{F_{x}}{F_{y}}
  $$

- 三元函数，一个方程：设方程$$F(x,y,z)=0$$在某区域内具有连续的偏导数$$F_{x}$$、$$F_{y}$$和$$F_{z}$$，且$$F_{z}\neq0$$，则

  $$
  z_{x} = -\frac{F_{x}}{F_{z}}\quad z_{x} = -\frac{F_{x}}{F_{z}}
  $$

- 二元函数，两个方程构成方程组：设方程组$$\begin{cases}F(x,y,u,v)=0\\G(x,y,u,v)=0\end{cases}$$，在一定条件下(比如$$ F、G $$具有连续偏导数，且雅可比行列式$$J = \frac{\partial (F,G)}{\partial (u,v)}=\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial v}\end{vmatrix}\neq0$$ )，此方程组能确定一对具有连续偏导数的隐函数$$u = u(x,y)$$，$$v = v(x,y)$$。由克莱姆法则可解得
  $$
  \begin{aligned}
  \frac{\partial u}{\partial x}=-\frac{1}{J}\frac{\partial (F,G)}{\partial (x,v)}=-\frac{\begin{vmatrix}\frac{\partial F}{\partial x}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial x}&\frac{\partial G}{\partial v}\end{vmatrix}}{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial v}\end{vmatrix}}\quad
  \frac{\partial v}{\partial x}=-\frac{1}{J}\frac{\partial (F,G)}{\partial (u,x)}=-\frac{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial x}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial x}\end{vmatrix}}{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial v}\end{vmatrix}}\\
  \frac{\partial u}{\partial y}=-\frac{1}{J}\frac{\partial (F,G)}{\partial (y,v)}=-\frac{\begin{vmatrix}\frac{\partial F}{\partial y}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial y}&\frac{\partial G}{\partial v}\end{vmatrix}}{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial v}\end{vmatrix}}\quad
  \frac{\partial v}{\partial y}=-\frac{1}{J}\frac{\partial (F,G)}{\partial (u,y)}=-\frac{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial y}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial y}\end{vmatrix}}{\begin{vmatrix}\frac{\partial F}{\partial u}&\frac{\partial F}{\partial v}\\\frac{\partial G}{\partial u}&\frac{\partial G}{\partial v}\end{vmatrix}}\\
  \end{aligned}
  $$

### 3.4 相关函数性质

- 驻点：一元函数中一阶导数为 0 的点，多元函数中所有偏导数同时为 0 的点，是极值点的候选点

- 极值点：函数取得局部极大值或局部极小值的点。多元函数极值点处所有偏导数为 0(极值点的必要条件是驻点)。

  一元函数可导的驻点为极值点。二元函数判定驻点中的极值点方法为：计算函数在驻点$$(x_\text{0},y_\text{0})$$处的二阶偏导数：$$A = f_{xx}(x_\text{0},y_\text{0})$$，$$B = f_{xy}(x_\text{0},y_\text{0})$$，$$C = f_{yy}(x_\text{0},y_\text{0})$$。

  - 若$$AC - B^2>0$$且$$A>0$$，则$$f(x_\text{0},y_\text{0})$$是极小值
  - 若$$AC - B^2>0$$且$$A<0$$，则$$f(x_\text{0},y_\text{0})$$是极大值
  - 若$$AC - B^2<0$$，则$$(x_\text{0},y_\text{0})$$不是极值点，是鞍点
  - 若$$AC - B^2 = 0$$，此方法无法判定

  比较开区域内驻点处的函数值和边界上的最值即可达到闭区域内函数的最值。

- 拐点：函数的二阶导数等于零且左右两侧二阶导数符号不同的点，函数的凹凸性在此点发生改变

- 单调性：从图像上容易看出，中学阶段已熟练掌握，不再赘述

- 凹凸性：如果一个有实值函数 f 对任意该区间内不相等的$$x$$和$$y$$和任意$$t \in [0, 1]$$有

  $$
   f(tx+(1−t)y)≥tf(x)+(1−t)f(y)
  $$

  则我们称$$f$$在某区间(或者某个向量空间中的凸集)上是凹的

  ![image-20250302220147474](../assets/post-pics/image-20250302220147474.png)

  注：国内部分数学教材的定义与国际相反，但经济学教材又与国际相同，此处以维基百科的定义为准，即图像的凹凸性与函数图像感受一致，但函数凹凸性与函数图像相反。

- 条件极值：除了定义域的限制外，还有其它约束，用拉格朗日乘子法求解

  1. 构建拉格朗日函数：设要求函数$$z = f(x,y)$$在约束条件$$\varphi(x,y)=0$$下的极值。引入拉格朗日乘数$$\lambda$$，构造拉格朗日函数$$L(x,y,\lambda)=f(x,y)+\lambda\varphi(x,y)$$
  2. 求偏导数并令其为零：分别对$$ x$$、$$y$$、$$\lambda$$求偏导并令为 0，得到方程组

     $$
     \begin{cases}L_{x} = f_{x}(x,y)+\lambda\varphi_{x}(x,y)=0\\L_{y} = f_{y}(x,y)+\lambda\varphi_{y}(x,y)=0\\L_{\lambda}=\varphi(x,y)=0\end{cases}
     $$

  3. 解方程组：解上述方程组，求出$$ x$$、$$y $$和$$\lambda$$的值。这些解对应的点$$(x,y)$$就是可能的极值点。

4. 判断极值：将求得的可能极值点代入原函数$$f(x,y)$$，比较这些点的函数值大小，从而确定是极大值还是极小值。

拉格朗日乘子法的基本思想是通过引入拉格朗日乘数$$\lambda$$，将条件极值问题转化为无条件极值问题。从几何角度来看，约束条件$$\varphi(x,y)=0$$表示一条曲线(在二维空间中)，而函数$$z = f(x,y)$$表示一个曲面。条件极值就是在这条曲线上找到使曲面$$z = f(x,y)$$取得极值的点。拉格朗日函数$$L(x,y,\lambda)$$的驻点恰好对应着在约束条件下函数$$f(x,y)$$的可能极值点。另外注意，该方法只是一种必要条件，即极值一定满足这个条件，但是满足这个条件的也不一定是极值，该方法只是提供了一种求条件极值的可能。

## 第四章 微分

微分的实质，是用切线增量近似曲线增量，是函数的局部线性化。(多元函数类似，即用切面立标增量代替曲面立标增量)

### 4.1 定义

#### 一元函数的微分

设$$f(x)$$在某区间$$I$$有定义，$$x_\text{0},x_\text{0} + \Delta x \in I$$，若$$\Delta y = f(x_\text{0} + \Delta x) - f(x_\text{0}) = A\Delta x + o(x)$$，其中$$A$$不依赖于$$\Delta x$$仅与$$x$$有关，$$o(x)$$是$$x\to 0$$时$$x$$的高阶无穷小，则称$$f(x)$$在$$x_\text{0}$$可微，$$A\Delta x$$为$$f(x)$$在$$x_\text{0}$$处相应于$$\Delta x$$的微分，记为$$\text{d}y_{x=x_\text{0}}$$，$$\text{d}y$$称为$$\Delta y$$的线性主部，是$$\Delta x$$的线性函数。若$$f(x)$$在$$I$$上每一点均可微，则$$f(x)$$是$$I$$上的可微函数。

微分的计算式如下

$$
\text{d}y = f'(x_\text{0}) \text{d}x
$$

微分可用于近似计算

$$
\begin{aligned}
\Delta y = f(x_\text{0} + \Delta x) - f(x_\text{0}) \approx f'(x_\text{0})\Delta x\\
即f(x_\text{0} + \Delta x) \approx f(x_\text{0}) + f'(x_\text{0})\Delta x\\
\end{aligned}
$$

令$$x_\text{0} + \Delta x = x$$，即$$\Delta x = x - x_\text{0}$$，则得到切线近似的表达式

$$
f(x) \approx f(x_\text{0}) + f'(x_\text{0})(x - x_\text{0})
$$

#### 全微分

设函数$$z = f(x,y)$$在点$$(x,y)$$的某邻域内有定义，若函数在点$$(x,y)$$处的全增量$$\Delta z = f(x + \Delta x,y + \Delta y)-f(x,y)$$可以表示为$$\Delta z = A\Delta x + B\Delta y + o(\rho)$$，其中$$A$$、$$B$$ 不依赖于$$\Delta x$$、$$\Delta y$$仅与$$x$$、$$y$$有关，$$\rho=\sqrt{(\Delta x)^2 + (\Delta y)^2}$$，$$o(\rho)$$是$$\rho\to0$$时$$\rho$$的高阶无穷小，则称函数$$z = f(x,y)$$在点$$(x,y)$$可微，$$A\Delta x + B\Delta y$$称为函数$$z = f(x,y)$$在点$$(x,y)$$的全微分，记作$$\text{d}z$$，将$$\Delta x$$、$$\Delta y$$分别记作$$\text{d}x$$、$$\text{d}y$$

全微分法则提供了全微分的计算式

$$
\text{d}z = f_{x}(x_\text{0}, y_\text{0}) \text{d}x + f_{y}(x_\text{0}, y_\text{0}) \text{d}y
$$

### 4.2 关系

一元函数中，连续不一定可导，可导一定连续。可导等价于可微，且$$A = f'(x)$$。

多元函数中，连续不一定有偏导数，有偏导数不一定连续。可微一定连续，且偏导数一定存在。连续或偏导数存在均不能推出可微。

### 4.3 计算

微分在计算上与导数无异，此处需要说明的是一阶微分形式不变性和一阶全微分形式不变性的问题

- 一阶微分形式不变性：主要针对一元函数。如果$$y = f(u)$$，无论$$ u $$是自变量还是中间变量，一阶微分$$\text{d}y = f'(u)\text{d}u$$的形式保持不变。
- 一阶全微分形式不变性：针对多元函数。设$$z = f(u, v)$$，不管$$ u$$、$$v $$是自变量还是中间变量，全微分$$\text{d}z=\frac{\partial z}{\partial u}\text{d}u+\frac{\partial z}{\partial v}\text{d}v$$的形式保持不变。

高阶微分不具有这种形式不变性，因为会出现微分的交叉项。

## 第五章 积分

几大类积分及其相互关系如图

![image-20250323120049021](../assets/post-pics/image-20250323120049021.png)

### 5.1 定义

#### 定义

不定积分定义为：$$f(x)$$的全体原函数$$F(x) + C$$称为$$f(x)$$在$$I$$内的不定积分。定积分、重积分、曲线积分和曲面积分的定义思路都是分割-近似-求和-取极限，不再一一列出。

$$
\begin{aligned}
&\int f(x)\text{d}x \quad &一元函数不定积分\\
&\int_{a}^{b}f(x)\text{d}x \quad &一元函数定积分\\
&\iint_{D}f(x,y)\text{d}\sigma \quad &二重积分\\
&\iiint_{\Omega}f(x,y,z)\text{d}V \quad &三重积分\\
&\int_{L}f(x,y)\text{d}s \quad &第一类曲线积分\\
&\int_{L}P(x, y)\text{d}x + Q(x, y)\text{d}y \quad &第二类曲线积分\\
&\iint_{\Sigma}f(x,y,z)\text{d}S \quad &第一类曲面积分\\
&\iint_{\Sigma}P(x,y,z)\text{d}y\text{d}z + Q(x,y,z)\text{d}z\text{d}x + R(x,y,z)\text{d}x\text{d}y \quad &第二类曲面积分\\
\end{aligned}
$$

#### 起源与应用

不定积分的概念起源于找原函数，属于微分学的内容。对一元函数，在$$I$$上，若$$F'(x) = f(x)$$，则$$F(x)$$称为$$f(x)$$的原函数；若$$f(x)$$在$$I$$上连续，则$$f(x)$$在$$I$$上有原函数。对二元函数，设函数$$z = f(x,y)$$在区域$$ D $$内具有一阶连续偏导数，如果存在一个函数$$u(x,y)$$，使得$$\text{d}u(x,y)=f(x,y)\text{d}x + g(x,y)\text{d}y$$，其中$$\text{d}u=\frac{\partial u}{\partial x}\text{d}x+\frac{\partial u}{\partial y}\text{d}y$$，那么称$$u(x,y)$$是$$f(x,y)$$的一个原函数。

定积分源于求曲边梯形的面积；重积分源于求曲顶柱体的体积和非匀质物体的质量；第一类曲线积分源于求曲线形构件的质量，第二类曲线积分源于求变力做功；第一类曲面积分源于求曲面形构件的质量，第二类曲面积分源于求曲面一侧的流量。积分广泛用于求解弧长、面积、体积、变力功、液体侧压力、引力、质量、质心、转动惯量等实际问题。

#### 关系

以二维为例，第一类曲线积分$$\int_{L}f(x,y)\text{d}s$$与第二类曲线积分$$\int_{L}P(x,y)\text{d}x + Q(x,y)\text{d}y$$之间的关系如下，其中$$\alpha$$和$$\beta$$分别为积分路径$$L$$上点的单位切向量与坐标轴正向的夹角

$$
\int_{L}P(x,y)\text{d}x + Q(x,y)\text{d}y=\int_{L}(P(x,y)\cos\alpha + Q(x,y)\cos\beta)\text{d}s
$$

以三维为例，第一类曲面积分$$\iint_{\sum}(P\cos\alpha + Q\cos\beta + R\cos\gamma)\text{d}S$$与第二类曲面积分$$\iint_{\sum}\vec{F}\cdot \text{d}\vec{S}$$之间的关系如下，其中$$\Sigma$$为有向曲面，其在点$$(x,y,z)$$处的单位法向量为$$\vec{n}=(\cos\alpha,\cos\beta,\cos\gamma)$$，向量场$$\vec{F}(x,y,z)=(P(x,y,z),Q(x,y,z),R(x,y,z))$$

$$
\begin{aligned}
\iint_{\Sigma}(P\cos\alpha + Q\cos\beta + R\cos\gamma)\text{d}S=\iint_{\Sigma}P\text{d}y \text{d}z + Q\text{d}z\text{d}x + R\text{d}x\text{d}y\\
\text{d}\vec{S}=\vec{n}\text{d}S = (\cos\alpha \text{d}S,\cos\beta \text{d}S,\cos\gamma \text{d}S)=(\text{d}y\text{d}z,\text{d}z\text{d}x,\text{d}x\text{d}y)
\end{aligned}
$$

### 5.2 性质

不定积分、定积分、重积分、曲线积分、曲面积分均满足线性性质，如

$$
\begin{aligned} \int \left[\alpha f(x) \pm \beta g(x) \right] \text{d}x &= \alpha\int f(x) \text{d}x \pm \beta\int g(x) \text{d}x \\
\iint_{D}[\alpha f(x,y)+\beta g(x,y)]\text{d}\sigma &= \alpha\iint_{D}f(x,y)\text{d}\sigma+\beta\iint_{D}g(x,y)\text{d}\sigma\\
\end{aligned}
$$

定积分、重积分、曲线积分、曲面积分还满足积分区间可加性，如

$$
\begin{aligned}
\int_{a}^{b} f(x) \, \text{d}x &= \int_{a}^{c} f(x) \, \text{d}x + \int_{c}^{b} f(x) \, \text{d}x\\
\iint_{D}f(x,y)\text{d}\sigma &= \iint_{D_\text{1}}f(x,y)\text{d}\sigma+\iint_{D_\text{2}}f(x,y)\text{d}\sigma\\
\end{aligned}
$$

第二类曲线积分具有有向性，规定闭曲线的正方向为，按闭曲线的正方向环绕，闭区域在线的左侧。

### 5.3 计算

线性运算是计算积分最强大的性质，所有积分均满足。另外，可以利用对称性简化运算。

#### 一元函数积分

- 凑微分法(第一换元法)：凑微分变量

- 变量替换法(第二换元法)：将$$x$$换为$$t$$的函数以简化积分计算，最后代换回$$x$$

  如：对于$$\sqrt{a^2 - x^2}$$的结构，令$$x = a\sin t$$

- 分部积分法：用于两类不同函数的乘积
  $$
  \begin{aligned} \int u \, \text{d}v &= uv - \int v \, \text{d}u \\ \int_{a}^{b} u \, \text{d}v &= uv \bigg|_\text{a}^{b} - \int_{a}^{b} v \, \text{d}u \end{aligned}
  $$

#### 二重积分

直角坐标系：根据积分区域为 X 型还是 Y 型选择投影方向和积分顺序

$$
\begin{aligned}
\iint_{D}f(x,y)\text{d}\sigma=\int_{a}^{b}\text{d}x\int_{\varphi_\text{1}(x)}^{\varphi_{2}(x)}f(x,y)\text{d}y, 当D=\{(x,y)\vert a\leqslant x\leqslant b,\varphi_{1}(x)\leqslant y\leqslant\varphi_\text{2}(x)\}\\
\iint_{D}f(x,y)\text{d}\sigma=\int_{c}^{{d}}\text{d}y\int_{\psi_\text{1}(y)}^{\psi_\text{2}(y)}f(x,y)\text{d}x,当D=\{(x,y)\vert c\leqslant y\leqslant {d},\psi_\text{1}(y)\leqslant x\leqslant\psi_\text{2}(y)\}\\
\end{aligned}
$$

对于更复杂的区域，可将其分割为若干个 X 型或 Y 型区域，利用积分的可加性计算

极坐标系：若积分区域$$D'$$由$$\alpha\leqslant\theta\leqslant\beta$$，$$r_\text{1}(\theta)\leqslant r\leqslant r_\text{2}(\theta)$$确定，将$$x = r\cos\theta$$，$$y = r\sin\theta$$，$$\text{d}\sigma = r\text{d}r \text{d}\theta$$代入二重积分

$$
\iint_{D}f(x,y)\text{d}\sigma=\iint_{D'}f(r\cos\theta,r\sin\theta)r \text{d}r \text{d}\theta=\int_{\alpha}^{\beta}\text{d}\theta\int_{r_\text{1}(\theta)}^{r_\text{2}(\theta)}f(r\cos\theta,r\sin\theta)r \text{d}r
$$

#### 三重积分

直角坐标系：同理选择投影方向和积分顺序，如积分区域$$\Omega$$由$$a\leqslant x\leqslant b$$，$$\varphi_\text{1}(x)\leqslant y\leqslant\varphi_\text{2}(x)$$，$$\psi_\text{1}(x,y)\leqslant z\leqslant\psi_\text{2}(x,y)$$确定

$$
\iiint_{\Omega}f(x,y,z)\text{d}V=\int_{a}^{b}\text{d}x\int_{\varphi_\text{1}(x)}^{\varphi_\text{2}(x)}\text{d}y\int_{\psi_\text{1}(x,y)}^{\psi_\text{2}(x,y)}f(x,y,z)\text{d}z
$$

柱坐标系：若积分区域$$\Omega'$$由$$\alpha\leqslant\theta\leqslant\beta$$，$$r_\text{1}(\theta)\leqslant r\leqslant r_\text{2}(\theta)$$，$$z_\text{1}(r,\theta)\leqslant z\leqslant z_\text{2}(r,\theta)$$确定，将柱坐标变换$$x = r\cos\theta$$，$$y = r\sin\theta$$，$$z = z$$，$$\text{d}V = r\text{d}r \text{d}\theta \text{d}z$$代入三重积分

$$
\iiint_{\Omega}f(x,y,z)\text{d}V=\iiint_{\Omega'}f(r\cos\theta,r\sin\theta,z)r \text{d}r \text{d}\theta \text{d}z=\int_{\alpha}^{\beta}\text{d}\theta\int_{r_\text{1}(\theta)}^{r_\text{2}(\theta)}r \text{d}r\int_{z_\text{1}(r,\theta)}^{z_\text{2}(r,\theta)}f(r\cos\theta,r\sin\theta,z)\text{d}z
$$

球坐标系：若积分区域$$\Omega''$$由$$\alpha\leqslant\theta\leqslant\beta$$，$$\varphi_\text{1}(\theta)\leqslant\varphi\leqslant\varphi_\text{2}(\theta)$$，$$\rho_\text{1}(\varphi,\theta)\leqslant\rho\leqslant\rho_\text{2}(\varphi,\theta)$$确定，将球坐标变换$$x = \rho\sin\varphi\cos\theta$$，$$y = \rho\sin\varphi\sin\theta$$，$$z = \rho\cos\varphi$$，$$\text{d}V=\rho^2\sin\varphi \text{d}\rho \text{d}\varphi \text{d}\theta$$代入三重积分

$$
\begin{aligned}
\iiint_{\Omega}f(x,y,z)\text{d}V&=\iiint_{\Omega''}f(\rho\sin\varphi\cos\theta,\rho\sin\varphi\sin\theta,\rho\cos\varphi)\rho^2\sin\varphi \text{d}\rho \text{d}\varphi \text{d}\theta\\
&=\int_{\alpha}^{\beta}\text{d}\theta\int_{\varphi_\text{1}(\theta)}^{\varphi_\text{2}(\theta)}\sin\varphi \text{d}\varphi\int_{\rho_\text{1}(\varphi,\theta)}^{\rho_\text{2}(\varphi,\theta)}f(\rho\sin\varphi\cos\theta,\rho\sin\varphi\sin\theta,\rho\cos\varphi)\rho^2\text{d}\rho
\end{aligned}
$$

#### 第一类曲线积分

以二维为例，设积分路径$$L$$的参数方程为$$\begin{cases}x = x(t)\\y = y(t)\end{cases}$$，$$t\in[\alpha,\beta]$$，则

$$
\int_{L}f(x,y)\text{d}s=\int_{\alpha}^{\beta}f(x(t),y(t))\sqrt{(x^\prime(t))^{2}+(y^\prime(t))^{2}}\text{d}t
$$

#### 第二类曲线积分

以二维为例，设积分路径$$L$$的参数方程为$$\begin{cases}x = x(t)\\y = y(t)\end{cases}$$，$$t\in[\alpha,\beta]$$，则利用参数方程的方法可得

$$
\int_{L}P(x,y)\text{d}x + Q(x,y)\text{d}y=\int_{\alpha}^{\beta}[P(x(t),y(t))x^\prime(t)+Q(x(t),y(t))y^\prime(t)]\text{d}t
$$

若$$P(x,y)$$，$$Q(x,y)$$在曲线围成的区域$$ D $$上具有一阶连续偏导数，则根据格林公式可得

$$
\oint_\text{L}P\text{d}x + Q\text{d}y=\iint_{D}(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y})\text{d}x\text{d}y
$$

当曲线$$ L $$不封闭时，可添加辅助线使其封闭并利用格林公式计算，最后减去辅助线上的积分。

#### 第一类曲面积分

以三维向$$xOy$$平面投影为例，设曲面$$\Sigma$$的方程为$$z = z(x,y)$$，$$(x,y)\in D_\text{xy}$$，$$D_\text{xy}$$是$$\Sigma$$在$$ xOy $$平面上的投影区域，则

$$
\iint_{\Sigma}f(x,y,z)\text{d}S=\iint_{D_\text{xy}}f(x,y,z(x,y))\sqrt{1 + z_{x}^{2}+z_{y}^{2}}\text{d}x\text{d}y
$$

#### 第二类曲面积分

以三维向$$xOy$$平面投影为例，设曲面$$\Sigma$$是由方程$$z = z(x,y)$$给出的有向曲面，取上侧，$$\Sigma$$在$$ xOy $$平面上的投影区域为$$D\_{xy}$$，则利用投影的方法可得

$$
\begin{aligned}
&\iint_{\Sigma}P(x,y,z)\text{d}y\text{d}z + Q(x,y,z)\text{d}z\text{d}x + R(x,y,z)\text{d}x\text{d}y\\
=&\iint_{D_{xy}}[P(x,y,z(x,y))(-z_{x}) + Q(x,y,z(x,y))(-z_{y}) + R(x,y,z(x,y))]\text{d}x\text{d}y
\end{aligned}
$$

若曲面取下侧，则前面的符号相反。

若空间闭区域$$\varOmega$$是由分片光滑的闭曲面$$\Sigma$$所围成，函数$$P(x,y,z)$$、$$Q(x,y,z)$$、$$R(x,y,z)$$在$$\varOmega$$上具有一阶连续偏导数，则根据高斯公式可得

$$
{\iiint}_{\varOmega}(\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}+\frac{\partial R}{\partial z})\text{d}V=∯_{\Sigma}P\text{d}y\text{d}z + Q\text{d}z\text{d}x + R\text{d}x\text{d}y
$$

其中$$\Sigma$$是$$\varOmega$$的整个边界曲面的外侧。当给定的曲面积分不是封闭曲面时，可添加辅助面使其封闭，再利用高斯公式计算，最后减去辅助面上的积分。

## 第六章 定理和公式

### 6.1 定理

#### 微积分基本定理

若$$f(x)$$在$$[a, b]$$连续，则积分上限函数$$\Phi(x) = \int_{a}^{x}f(t)\text{d}t$$在$$[a, b]$$可导，且导数为$$f(x),x \in [a, b]$$；显然，$$\Phi(x)$$为$$f(x)$$在$$[a, b]$$上的一个原函数。

#### 最值定理

如果函数 $$f(x)$$在闭区间$$[a, b]$$上连续，那么 $$f(x)$$在这个区间上一定能取得最大值和最小值。也就是说，存在两个点$$x_\text{1}$$和$$x_\text{2}$$，使得：

$$
 f(x_\text{1}) \leqslant f(x) \leqslant f(x_\text{2}), \quad \text{对于} \ x \in [a, b]
$$

#### 介值定理

如果函数 $$f(x)$$在闭区间$$[a, b]$$上连续，且$$f(a) \neq f(b)$$，那么对于任意一个介于 $$f(a)$$和 $$f(b)$$ 之间的值$$c$$，必然存在一个点$$x_\text{0} \in (a, b)$$，使得

$$
f(x_\text{0}) = c
$$

零点存在定理是介值定理的特例。

#### 费马定理

如果函数$$f(x)$$在$$c$$处取得局部极值，且$$f(x)$$在$$c$$处可导，则

#### 罗尔中值定理

若$$f(x)$$在$$[a, b]$$上连续，在$$(a, b)$$上可导，$$f(a) = f(b)$$，则存在$$c \in (a, b)$$使得

$$
 f'(c) = 0
$$

#### 拉格朗日中值定理

若$$f(x)$$在$$[a, b]$$上连续，在$$(a, b)$$上可导，则存在$$c \in (a, b)$$使得

$$
 f'(c) = \frac{f(b) - f(a)}{b - a}
$$

#### 柯西中值定理

若$$f(x),g(x)$$均在$$[a, b]$$上连续，在$$(a, b)$$上可导，$$g(x)$$在$$(a, b)$$上非零，则存在$$c \in (a, b)$$使得

$$
 \frac{f'(c)}{g'(c)} = \frac{f(b) - f(a)}{g(b) - g(a)}
$$

#### 估值定理

若$$f(x)$$在$$[a, b]$$上可积，$$M,m$$为最值，则

$$
m(b - a) \leqslant \int_{a}^{b} f(x) \, \text{d}x \leqslant M(b - a)
$$

重积分、曲线积分和曲面积分也有类似的性质，不再一一列出

#### 积分中值定理

若$$f(x)$$在$$[a, b]$$上连续，则存在$$c \in [a, b]$$使得

$$
\int_{a}^{b} f(x) \, \text{d}x = f(c) (b - a)
$$

重积分、曲线积分和曲面积分也有类似的性质，不再一一列出

#### 广义积分中值定理

$$f(x)$$连续，$$g(x)$$可积且不变号，则存在$$c \in [a, b]$$使得

$$
 \int_{a}^{b} f(x) g(x) \, \text{d}x = f(c) \int_{a}^{b} g(x) \, \text{d}x
$$

### 6.2 公式

#### 牛顿-莱布尼茨公式

也称微积分基本公式，揭示了微分和积分的紧密联系

若$$F(x)$$是$$f(x)$$在$$[a, b]$$上的一个原函数，则

$$
\int_{a}^{b} f(x) \, \text{d}x = F(b) - F(a)
$$

这个公式应用到复合函数上有，若$$f(t)$$连续，$$\alpha(x),\beta(x)$$可导，则$$F(x) = \int_{\alpha(x)}^{\beta(x)}f(t)\text{d}t$$的导数为

$$
 F'(x) = f([\beta(x)])\beta'(x) - f([\alpha(x)])\alpha'(x)
$$

#### 泰勒公式

泰勒公式的来源，是微分在某一点对函数进行的局部线性化；泰勒公式将其推广为，用多项式函数对函数进行全局逼近，用多项式仿造出满足精度要求的目标函数。

![v2-9dd69ab2c20ca721bc0979d7ebaa0253_720w](../assets/post-pics/v2-9dd69ab2c20ca721bc0979d7ebaa0253_720w.webp)

带皮亚诺余项的泰勒公式：设$$f(x)$$在$$x_\text{0}$$的某邻域内具有直到$$n$$阶的导数，则对此邻域中的任何$$x$$有

$$
\displaystyle f(x) = f(a) + f'(a)(x - a) + \frac{f''(a)}{2!}(x - a)^2 + \cdots \\+ \frac{f^{(n)}(a)}{n!}(x - a)^n + o((x - a)^n)
$$

带拉格朗日余项的泰勒公式：设$$f(x)$$在$$x_\text{0}$$的某邻域内具有直到$$n + 1$$阶的导数，则对此邻域中的任何$$x$$有

$$
\displaystyle f(x) = f(a) + f'(a)(x - a) + \frac{f''(a)}{2!}(x - a)^2 + \cdots \\+ \frac{f^{(n)}(a)}{n!}(x - a)^n + \frac{f^{(n+1)}(\xi)}{(n+1)!}(x - a)^{n+1}
$$

多元函数的泰勒公式：设函数$$z = f(x,y)$$在点$$(x_\text{0},y_\text{0})$$的某一邻域内具有直到$$n + 1$$阶的连续偏导数，则对于该邻域内的任意一点$$(x,y)$$，公式如下，其中，$$R_\text{n}=\frac{1}{(n + 1)!}[(x - x_\text{0})\frac{\partial}{\partial x}+(y - y_\text{0})\frac{\partial}{\partial y}]^{n + 1}f(\xi,\eta)$$，$$(\xi,\eta)$$是介于$$(x_\text{0},y_\text{0})$$和$$(x,y)$$之间的某一点，$$f_{x},f_{y},f_{xx},f_{xy},f_{yy}$$等分别表示$$f(x,y)$$对 x，y 的一阶、二阶偏导数。

$$
\begin{aligned}
f(x,y)=f(x_\text{0},y_\text{0})&+(x - x_\text{0})f_{x}(x_\text{0},y_\text{0})\\
&+(y - y_\text{0})f_{y}(x_\text{0},y_\text{0})+\frac{1}{2!}[(x - x_\text{0})^2f_{xx}(x_\text{0},y_\text{0})\\
&+2(x - x_\text{0})(y - y_\text{0})f_{xy}(x_\text{0},y_\text{0})+(y - y_\text{0})^2f_{yy}(x_\text{0},y_\text{0})]+\cdots\\
&+\frac{1}{n!}[(x - x_\text{0})\frac{\partial}{\partial x}+(y - y_\text{0})\frac{\partial}{\partial y}]^nf(x_\text{0},y_\text{0})+\text{R}_\text{n} \end{aligned}
$$

#### 麦克劳林公式

泰勒公式的特例，将$$a = 0$$代入即可，常见的麦克劳林公式有：

$$
\begin{aligned} \text{e}^x &= 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots \\ \sin x &= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots \\ \cos x &= 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots \\ (1+x)^\alpha &= 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + \frac{\alpha(\alpha-1)(\alpha-2)}{3!}x^3 + \cdots \\ \ln(1+x) &= x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \cdots \\ \frac{1}{1+x} &= 1 - x + x^2 - x^3 + x^4 - \cdots \\ \frac{1}{1-x} &= 1 + x + x^2 + x^3 + x^4 + \cdots \end{aligned}
$$

#### 莱布尼茨公式

用于求乘积的高阶导数

$$
\frac{\text{d}^n}{\text{d}x^n} [f(x) \cdot g(x)] = \sum_\text{k=0}^{n} \binom{n}{k} f^{(k)}(x) g^{(n-k)}(x)
$$

#### 格林公式

设闭区域$$ D $$由分段光滑的曲线$$ L $$围成，函数$$P(x,y)$$及$$Q(x,y)$$在$$ D $$上具有一阶连续偏导数，有如下关系，其中$$ L $$是$$ D $$的取正向的边界曲线

$$
\iint_{D}(\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y})\text{d}x\text{d}y=\oint_\text{L}P\text{d}x + Q\text{d}y
$$

格林公式将封闭曲线的线积分和区域上的二重积分建立联系

#### 高斯公式

设空间闭区域$$\varOmega$$由分片光滑的闭曲面$$\Sigma$$所围成，函数$$P(x,y,z)$$、$$Q(x,y,z)$$、$$R(x,y,z)$$在$$\varOmega$$上具有一阶连续偏导数，有如下关系(散度的三重积分=通量)，其中$$\Sigma$$是$$\varOmega$$的整个边界曲面的外侧。

$$
\iiint_{\varOmega}(\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}+\frac{\partial R}{\partial z})\text{d}V=\iint_{\Sigma}P\text{d}y\text{d}z +Q\text{d}z\text{d}x + R\text{d}x\text{d}y = \iint_{\Sigma}\vec{A}\cdot \text{d}\vec{S}
$$

高斯公式将闭曲面上的第二类曲面积分和闭曲面所围成空间区域内的三重积分建立联系

#### 斯托克斯公式

设$$\varGamma$$为分段光滑的空间有向闭曲线，$$\Sigma$$是以$$\varGamma$$为边界的分片光滑的有向曲面，$$\varGamma$$的正向与$$\Sigma$$的侧符合右手规则，函数$$P(x,y,z)$$、$$Q(x,y,z)$$、$$R(x,y,z)$$在包含曲面$$\Sigma$$在内的一个空间区域内具有一阶连续偏导数，有如下关系(旋度的第二类曲面积分，即旋度场的通量=环量)

$$
\iint_{\Sigma}(\frac{\partial R}{\partial y}-\frac{\partial Q}{\partial z})\text{d}y\text{d}z + (\frac{\partial P}{\partial z}-\frac{\partial R}{\partial x})\text{d}z\text{d}x + (\frac{\partial Q}{\partial x}-\frac{\partial P}{\partial y})\text{d}x\text{d}y=\oint_{\varGamma}P\text{d}x + Q\text{d}y + R\text{d}z
$$

斯托克斯公式是格林公式在空间曲线上的推广，将空间曲线积分和曲面积分建立联系

## 第七章 微分方程

微分方程，即含有未知数及其导数的方程；求解微分方程，就是从这个隐性关系中提取明确的变量关系，从几何意义上说，就是根据切线画曲线。

### 7.1 基本概念与分类

微分方程的阶数取决于最高次导数阶数。

常微分方程(ODE)是仅含有一个独立变量的微分方程；偏微分方程(PDE)是含有两个及以上独立变量的微分方程。偏微分方程通常被作为一个独立的数学分支进行研究。

根据附加条件的不同，微分方程解决的问题可分为初值问题(IVP)和边界值(BVP)问题两类。初值问题的未知函数及其导数的独立变量取值相同；边界值问题的未知函数及其导数的独立变量取值不同。

线性方程中未知函数及其导数的各项都是一次的，且不包含未知函数的乘积或非线性函数。非线性方程中未知函数或其导数有乘积、幂次、非线性函数等情况。

简化后的方程中所有非零项的指数相等称为齐次方程。

$$n$$阶线性微分方程通式为

$$
k_{n}(x)y^{(n)} + k_{n - 1}(x)y^{(n - 1)} + \cdots + k_\text{1}(x)y' + k_\text{0}(x)y = g(x)
$$

若$$g(x) = 0$$则称为齐次线性微分方程，否则称为非齐次线性微分方程

若所有系数$$k_\text{j}(x), j = 0, 1, 2, \cdots, n$$均为常数，则称为常系数线性微分方程，否则称为变系数线性微分方程

### 7.2 微分方程解的特性

通解是所有满足方程的函数的集合；特解是满足某些初始条件或边界条件的解。

#### 解的线性相关性

如果在某一区间$$x \in (a, b)$$，存在一组不全为 0 的常数$$C_\text{1}, C_\text{2}, \cdots, C_\text{n}$$使得一组函数$$y_\text{1}(x), y_\text{2}(x), \cdots, y_\text{n}(x)$$满足

$$
C_{1}y_{1}(x) + C_{2}y_{2}(x) + \cdots + C_{n}y_{n}(x) \equiv 0
$$

则这组函数$$y_{1}(x), y_{2}(x), \cdots, y_{n}(x)$$在区间$$x \in (a, b)$$上线性相关

若当且仅当$$C_{1} = C_{2} = \cdots = C_{n} = 0$$时，该函数集合线性无关

函数组线性无关判定的一种方法是 Wronskian 行列式。

#### 齐次和非齐次

线性微分方程解的特性：$$n$$阶齐次线性微分方程一定有$$n$$个线性无关的解；它们构成该$$n$$阶齐次线性微分方程的基本解组；该方程的通解可以用这$$n$$个线性无关的解加权线性叠加表示。线性微分方程的通解一定是所有解；非线性微分方程则不一定。

非齐次线性微分方程

$$
k_{n}(x)y^{(n)} + k_{n - 1}(x)y^{(n - 1)} + \cdots + k_{1}(x)y' + k_{0}(x)y = g(x)
$$

$$g(x) \ne 0$$时，称为非齐次线性微分方程，对应的齐次方程为

$$
 k_{n}(x)y^{(n)} + k_{n - 1}(x)y^{(n - 1)} + \cdots + k_{1}(x)y' + k_{0}(x)y = 0
$$

令$$y_{p}$$为非齐次方程$$L(y) = g(x)$$的特解，$$y_{h}$$为对应齐次方程的通解，则非齐次方程的通解为

$$
 y = y_{p} + y_{h}
$$

即：非齐次方程通解 = 对应齐次方程通解 + 非齐次方程特解

初值问题通常具有唯一解，解可能只在$$t_\text{0}$$附近的一个区间有效，且解对初始条件敏感；边界值问题可能无解或有多个解，解通常在整个区间$$[t_\text{1}, t_\text{2}]$$上定义，解的类型可能受边界值约束。

### 7.3 特定形式微分方程的解法

微分方程的标准形式

$$
y' = f(x, y) \\
\frac{\text{d}y}{\text{d}x} = \frac{M(x, y)}{-N(x, y)}
$$

微分方程的微分形式

$$
M(x, y) \, \text{d}x + N(x, y) \, \text{d}y = 0
$$

#### 可分离变量微分方程

对于微分形式，若满足$$M(x, y) = M(x)$$和$$N(x, y) = N(y)$$则称为可分离变量的微分方程

$$
M(x) \, \text{d}x + N(y) \, \text{d}y = 0
$$

解法：直接积分

$$
\int M(x) \, \text{d}x + \int N(y) \, \text{d}y = C
$$

例如

$$
\begin{aligned} \frac{\text{d}y}{\text{d}x} &= \frac{x^2 + 2}{y} \\ (x^2 + 2) \, \text{d}x - y \, \text{d}y &= 0 \\ \frac{1}{3} x^3 + 2x - \frac{1}{2} y^2 &= C \end{aligned}
$$

#### 齐次微分方程

对于一阶微分方程，如果实数$$t$$满足

$$
 f(tx, ty) = f(x, y)
$$

则称为齐次方程(注：此处的”齐次“在狭义上仅针对一阶微分方程成立，且与齐次线性微分方程中的”齐次“并非统一概念)

解法：令$$y = vx,v = v(x)$$，有$$\frac{\text{d}y}{\text{d}x} = v + x \frac{\text{d}v}{\text{d}x}$$

例如

$$
 y' = \frac{y + x}{x}
$$

令$$y = vx$$，代入

$$
\begin{aligned} v + x \frac{\text{d}v}{\text{d}x} &= v + 1 \\ v &= \ln|x| + C \\ y &= \ln|kx| \end{aligned}
$$

#### 恰当方程

对于微分形式，若满足$$M(x, y)$$和$$N(x, y)$$都是连续函数且在 $$𝑥𝑦$$ 平面上的具有一阶连续偏导，当且仅当下式成立

$$
 \frac{\partial M(x, y)}{\partial y} = \frac{\partial N(x, y)}{\partial x}
$$

则称为恰当方程

或：若存在函数$$g(x, y)$$满足

$$
\text{d}g(x, y) = M(x, y) \, \text{d}x + N(x, y) \, \text{d}y
$$

则称为恰当方程

- 恰当方程的解为$$g(x, y) = C$$

解法： 若原方程为恰当方程，利用$$\frac{\partial g(x, y)}{\partial x} = M(x, y)$$对$$x$$积分，常数项为$$h(y)$$， 再利用$$\frac{\partial g(x, y)}{\partial y} = N(x, y)$$解出

例如

$$
2xy \, \text{d}x + (1 + x^2) \, \text{d}y = 0
$$

因为

$$
 \frac{\partial M(x, y)}{\partial y} = \frac{\partial N(x, y)}{\partial x} = 2x
$$

所以原方程为恰当方程

$$
 \begin{aligned} \frac{\partial g(x, y)}{\partial x} &= M(x, y) = 2xy\\ g(x, y) &= x^2y + h(y)\\ \frac{\partial g(x, y)}{\partial y} &= x^2 + h'(y) = N(x, y) = 1 + x^2 \end{aligned}
$$

故

$$
 \begin{aligned} h'(y) &= 1\\ h(y) &= y + C_\text{1}\\ g(x, y) &= x^2y + y + C_\text{1} = C \end{aligned}
$$

即

$$
 x^2y + y = C_\text{2}
$$

若原方程不是恰当方程，在某些特殊情形下可以转化为恰当方程

令$$I(x, y)$$为积分因子，则$$I(x, y) [M(x, y) \, \text{d}x + N(x, y) \, \text{d}y] = 0$$ 可以转化为恰当方程

1. 满足$$\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right) \equiv g(x)$$，即结果仅为$$x$$的函数，则$$I(x, y) = \text{e}^{\int g(x)\text{d}x}$$
2. 满足$$\frac{1}{M} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right) \equiv h(y)$$，即结果仅为$$y$$的函数，则$$I(x, y) = \text{e}^{-\int h(y)\text{d}y}$$
3. 满足$$M = yf(xy), N = xg(x, y)$$，则$$I(x, y) = \frac{1}{xM - yN}$$

#### 一阶线性微分方程

对于一阶的标准形式，如果$$f(x, y)$$可以写成

$$
 f(x, y) = -p(x)y + q(x)
$$

则微分方程可以写成如下形式

$$
 y' + p(x)y = q(x)
$$

用常数变易法的思想，线性非齐次常微分方程一定能分解为对应齐次方程和降阶的非齐次方程(类似于因式分解)。

解法：令$$y(x) = u(x)v(x)$$(为了分离变量)，则$$\frac{\text{d}y}{\text{d}x} = v \frac{\text{d}u}{\text{d}x} + u \frac{\text{d}v}{\text{d}x}$$ ，代入

$$
v \frac{\text{d}u}{\text{d}x} + u \left( \frac{\text{d}v}{\text{d}x} + P(x) v \right) = Q(x)
$$

令$$\frac{\text{d}v}{\text{d}x} + P(x) v = 0$$ 可得

$$
v(x) = C_\text{1} \int \text{e}^{-P(x)} \, \text{d}x
$$

代入原方程得

$$
u(x) = \frac{1}{C_\text{1}} \int Q(x) \text{e}^{\int P(x) \, \text{d}x} \, \text{d}x + C_\text{2}
$$

因此

$$
y = \frac{\int Q(x) \text{e}^{\int P(x) \, \text{d}x} \, \text{d}x + C}{\text{e}^{\int P(x) \, \text{d}x}}
$$

恰当方程角度的解法：因为满足$$\frac{1}{N} \left( \frac{\partial M}{\partial y} - \frac{\partial N}{\partial x} \right) \equiv p(x)$$，即所有一阶线性微分方程都可以转化为恰当方程，积分因子$$I(x) = \text{e}^{\int p(x) \, \text{d}x}$$

原方程转化为

$$
\frac{\text{d} (y I(x))}{\text{d}x} = I(x) q(x)
$$

对$$x$$积分并整理得

$$
y = \frac{\int I(x) q(x) \, \text{d}x + C}{I(x)}
$$

例如

$$
\begin{aligned} y' + \frac{4}{x}y &= x^4 \\ I(x) &= \text{e}^{\int \frac{4}{x} \, \text{d}x} = x^4 \\ y &= \frac{\int x^8 \, \text{d}x + C}{x^4} = \frac{1}{9}x^5 + \frac{C}{x^4} \end{aligned}
$$

#### 伯努利方程

$$
 y' + p(x)y = q(x)y^n
$$

其中$$n$$为实数

解法：令$$z = y^{1 - n}$$，转化为一阶线性微分方程，后续步骤完全同一阶线性微分方程，不再举例，最后记得换回$$y$$为因变量即可。

#### 高阶常系数线性齐次微分方程

$$n$$阶常系数线性齐次微分方程

$$
y^{(n)} + p_\text{1}y^{(n-1)} + \cdots + p_{n-1}y' + p_{n}y = 0
$$

求解思路有两种，一种是经典法，一种是拉普拉斯变换法。

二阶常系数线性齐次微分方程的经典解法：特征方程法($$n$$阶常系数方程同理)

$$
 y'' + py' + qy = 0
$$

令$$y = \text{e}^{rx}$$，代入原方程得到特征方程$$r^2 + pr + q = 0$$，解得特征方程的根为$$r_\text{1},r_\text{2}$$，特征方程根的判别式为$$\Delta$$，则齐次方程通解如下

$$
\begin{cases} y = C_\text{1}\text{e}^{r_\text{1}x} + C_\text{2}\text{e}^{r_\text{2}x}, \Delta > 0\\ y = (C_\text{1} + C_\text{2}x)\text{e}^{r_\text{1}x}, \Delta = 0\\ y = (C_\text{1}\cos \beta x + C_\text{2} \sin \beta x)\text{e}^{\alpha x},\Delta < 0 \end{cases}
$$

#### 高阶常系数线性非齐次微分方程

$$
y^{(n)} + p_{1}y^{(n-1)} + \cdots + p_{n-1}y' + p_{n}y = f(x)
$$

解法思路均为待定系数法求出特解，加上对应齐次方程的通解即为非齐次方程的通解，齐次方程通解求法见上。此处给出二阶常系数线性非齐次微分方程中的两种特定形式求特解的方法。

第一种

$$
y'' + py' + qy = {e}^{\lambda x} P_{m}(x)
$$

令$$y^* = {e}^{\lambda x} \cdot Q(x), Q(x) = x^k \cdot Q_{m}(x)$$，代入方程求两次导得

$$
Q''(x) + (2\lambda + p)Q'(x) + (\lambda^2 + p\lambda + q)Q(x) = P_{m}(x)
$$

$$
 \begin{cases} \begin{aligned} &若\lambda^2 + p\lambda + q \neq 0，&\lambda 不是特征根\\ &若\lambda^2 + p\lambda + q = 0，但 2\lambda + p \neq 0, &\lambda 是单重特征根\\ &若 2\lambda + p = 0, &\lambda 是双重特征根 \end{aligned} \end{cases}
$$

同时对比系数可求出$$Q_{m}(x)$$中的系数

$$
y^* = x^k \cdot {e}^{\lambda x} \cdot Q_{m}(x), k = \begin{cases} 0, \lambda 不是特征根\\ 1, \lambda 是单重特征根\\ 2, \lambda 是双重特征根 \end{cases}
$$

第二种

$$
y'' + py' + qy = {e}^{\alpha x}[P_{l}(x) \cos\beta x + P_{n}(x) \sin\beta x]
$$

将右侧化为$${e}^{\lambda x}\cdot P_{m}(x)$$的形式，其中$$\lambda$$为复数

令$$y^* = x^k \cdot {e}^{\alpha x} \cdot[R_{m}(x)\cos \beta x + R_{m}(x)\sin \beta x]$$，代入求导，对比可求得系数

其中

$$
k = \begin{cases} 0, \alpha + i\beta 不是特征根\\ 1, \alpha + i\beta 是特征根 \end{cases}
$$

#### 欧拉方程

$$
x^n y^{(n)} + p_\text{1}x^{n-1}y^{(n-1)} + \cdots + p_{n-1}y' + p_{n}y = f(x)
$$

解法：令$$\begin{cases} x=\text{e}^t, x>0\\ x=-\text{e}^t, x<0 \end{cases}$$，代入，转化为常系数线性非齐次微分方程，后续步骤完全同常系数线性非齐次微分方程，不再举例，最后记得换回$$y$$为因变量即可。

#### 全微分方程

一阶微分方程$$P(x,y)\text{d}x + Q(x,y)\text{d}y = 0$$的左端恰好是某个二元函数$$u(x,y)$$的全微分，即$$\text{d}u(x,y)=P(x,y)\text{d}x + Q(x,y)\text{d}y$$，那么称该方程为全微分方程。判定时，如果$$P(x,y)$$和$$Q(x,y)$$在某区域$$D$$内具有一阶连续偏导数，且$$\frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}$$

当方程$$P(x,y)\text{d}x + Q(x,y)\text{d}y = 0$$是全微分方程时，其通解为$$u(x,y)=C$$，其中$$u(x,y)$$是满足$$\text{d}u = P\text{d}x + Q\text{d}y$$的函数，可通过积分来求得$$u(x,y)$$，

$$
u(x,y)=\int_{x_\text{0}}^{x}P(x,y_\text{0})\text{d}x+\int_{y_\text{0}}^{y}Q(x,y)\text{d}y
$$

## 参考资料

[反双曲函数](https://blog.csdn.net/weixin_48524215/article/details/120690188)

[双曲和反双曲函数推导、性质及联系](https://yangzhang.site/SomeMath/real/hyperbolic_function/#_2)

[维基百科——凹函数](https://zh.wikipedia.org/zh-cn/凹函数)

[理解泰勒函数](https://www.zhihu.com/question/25627482)

[微积分的本质](https://www.bilibili.com/video/BV1qW411N7FU/?spm_=333.337)

[Tera 知识库](https://www.zhihu.com/column/c_1196023055833497600)

[散度与旋度](https://www.bilibili.com/video/BV19s41157Z4/)

[齐次和线性的含义](https://www.cnblogs.com/LitBro/p/14198356.html)

[朗斯基行列式判断线性相关性](https://zhuanlan.zhihu.com/p/85230665)

[常数变易法的思想来源](https://www.zhihu.com/question/31329122)
