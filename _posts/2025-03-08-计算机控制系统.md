---
title: 计算机控制系统
description: 课程笔记
author: Hatrix
date: 2025-03-08 17:40:00 +0800
categories: [电子技术]
tags: [课程笔记]
math: true
mermaid: true
---

前序课程：电子技术、微机原理、控制理论

成绩构成：30%+70%（主观题+客观题）

乐学提交，平时考勤，雨课堂发布课件

第二章第三章为硬件设计、第四章到第六章为软件设计。重点在第二章，第八章的电磁兼容性略（通俗来说就是抗干扰设计），第九章自学

![image-20250310094527296](../assets/post-pics/image-20250310094527296.png)

## CCS 概念

计算机控制系统（CCS）：是应用计算机参与控制并借助一些辅助部件与被控对象相联系，以获得一定控制目的而构成的系统。

计算机通常指数字计算机，有通用的到通用的到专用的。 辅助部件主要是输入输出接口、检测装置（传感器）和执行装置。联系可以通过有线或无线。控制目的可以是状态或运动过程达到某种要求，也可以是达到某种最优化目标。依据控制目的推出控制器的设计。

## CCS 特点

精度高、运算速度快、存储容量大、有逻辑判断功能。可以实现高级复杂的控制方法，获得快速精密的控制效果。

# 第一章：概述

## 1.1 一般概念

控制系统分为开环和闭环，开环系统的输出量对系统的控制作用没有影响，开环系统的精度取决于系统各环节（包括被控对象）的参数稳定性，所以控制性能相对较差。 闭环控制系统的输出量对系统的控制作用有直接的影响。另外，自动控制系统可以分成调节系统和伺服系统（随动系统）两类。调节系统的输入信号一般保持不变，保持系统状态稳定；而伺服系统则要求被控对象的状态能复现输入信号的变化。

闭环系统中一定要有检测装置对输出量进行检测，要有比较装置对系统的输入量和输出量进行比较，给出偏差信号，起信号综合作用。由于偏差信号幅值较小，需要放大器对微弱偏差信号进行放大，使之能够输出足够的功率。执行环节根据放大的偏差信号，对被控对象执行控制任务，使被控的输出量于给定量一致。 控制器也称校正装置，用于改善系统的性能。将它们串联起来可以构成最简单的闭环控制系统框图。最重要的两个装置就是控制器和检测装置。将控制器用计算机来实现，并加入 AD、DA 就是 CCS

![image-20250224111125243](../assets/post-pics/image-20250224111125243.png)

### AD 和 DA 转换

AD 包含三种形式的转换：

- 模拟信号采样：按一定的时间间隔对连续信号进行采样，将其变为时间上断续的离散信号。（使得在时间上只能离散）

- 信号幅值的整量化：按照信号幅值按有限字长的最小量化单位分层取整，变为离散的信号。（使得在幅值上只能离散）

- 数字编码：已整量化的分层信号转换为等值的二进制数码信号，即数字信号。

DA 转换包含两种形式的转换：

- 数字解码：把数字量转换为等值的模拟脉冲信号。（使得在幅值上允许存在连续）

- 信号恢复：把解码之后的模拟脉冲信号变为随时间连续变化的信号（使得在时间上允许连续，恢复精度与 AD 时的采样周期有关，可以用零阶保持器实现）

引入了计算机之后，系统就变成了离散时间控制系统。

### 工作过程

- 实时数据采集：对被控参数的瞬时值进行检测、转换并输入到计算机中。

- 实时决策：对实时的给定值和被控量的数值进行分析，并按已定的控制规律进行计算，以决定进一步的控制策略。

- 实时控制：根据决策，实时地对执行机构发出控制信号

这三个步骤周而复始循环，就可以完成对被控对象地控制。实时的意思是信号的输入、计算和输出都是在一定时间范围内完成，要求计算机对输入信息以足够快的速度进行处理，并在一定的时间内作出反应或控制。只要延迟时间不错过控制的时机，便认为系统具有实时性。

### 实时性指标

实时需要考虑两个要素，一是根据被控过程出现的事件能保持多长时间；二是该事件要求计算机在多长的时间内必须做出反应。因此，系统的实时性指标取决于：检测仪表延时，过程输入(A/D)延时，计算机运算延时，数据传输(D/A)延时、执行机构延时等。由上面三步所构成的循环周期就是实时时间，也称为采样周期 Ts；显然，采样周期需要考虑这些不可避免的各个环节的延时。本书主要讨论计算机控制伺服系统，控制对象大多是快速变化对象，因此要求的实时时间一般为毫秒级。计算机控制系统的实时时间常由定时中断产生。

![image-20250224112032615](../assets/post-pics/image-20250224112032615.png)

### 在线方式和离线方式

被控对象和计算机直接连接，并接受计算机控制的方式称为在线方式/联机方式，反之则称为离线方式或脱机方式。在线系统不一定是实时系统，但实现系统一定是在线的。

### CCS 的特点

1. 计算机控制系统是混合信号系统
2. 系统包含多种信号形式
3. 计算机控制系统的分析和设计需要先进的理论支持
4. 能实现复杂的控制规律，且控制规律灵活多样
5. 计算机控制系统可分时控制多个回路，适应性强，灵活性高
6. 计算机控制系统使得控制与管理容易结合并实现更高层次的自动化，提高了企业自动化程度
7. 计算机控制系统能够比较方便地实现系统的自动检测和故障诊断，提供了系统的可靠性和容错、维修能力

## 1.2CCS 组成

### 硬件组成

（虚线框内为实时控制所必须的最小系统配置）

![image-20250224112308751](../assets/post-pics/image-20250224112308751.png)

- 主机：由 CPU、内存储器及时钟电路组成，是控制系统的核心。常用的计算机控制系统主机有可编程序控制器(PLC)、工控机(IPC)、单片机、DSP(数字信号处理器)、智能调节器(智能调节器是一种数字化的过程控制仪表)等。
- 标准外部设备：按功能分为三类

  - 输入设备：键盘、鼠标、游戏操作杆、光笔、触摸屏、扫描仪、麦克风、摄像机、数码相机等
  - 输出设备：打印机、绘图仪、显示器、投影仪、音响等
  - 外存储器：磁盘、磁带、光盘等，兼有输入和输出两种功能

- 过程通道/输入输出通道

  按照模拟量/数字量，输入/输出分类，排列组合有四大类：

  - 模拟量输入通道（A/D 通道）
  - 开关量输入通道（DI 通道）
  - 模拟量输出通道（D/A 通道）
  - 开关量输入通道（DO 通道）

- 接口：协调计算机与外设和过程通道的工作

- 人机联系设备/人机接口：作用是显示生产过程的状况、供生产操作人员使用，显示操作结果。系统中的操作员有系统操作员和生产操作员，人机接口的一个要求是需要具有容错性。

- 通信设备：完成不同位置、不同功能的计算机或设备间的信息交换

### 软件组成

- 系统软件：包括操作系统、程序设计系统、通信网络软件和诊断系统等，具有一定的通用性
- 应用软件：包括控制算法程序、输入/输出接口程序、监控程序和信息管理程序等

计算机控制系统是实时在线运行的系统，在构建软硬件系统时，必须充分保证系统运行的实时性和可靠性。

## 1.3 CCS 结构形式

计算机控制系统分类的方法有很多种，按照计算机参与控制方式分类，可分成以下几种类型：操作指导控制系统、直接数字控制系统、监督控制系统、集散控制系统、现场总线控制系统、综合自动化系统

## 1.4 发展概况和发展趋势

略

# 第二章：通道接口技术

通道接口需要完成两个任务，一是将被控对象需要控制的物理量经信息转换后送入到计算机（输入通道设计），二是将计算机执行出来的控制量完成控制指令转换并送入到执行机构（输出通道）

## 2.1 计算机对外围通道的控制

计算机对外围通道的控制，其基础是中断系统，具体则通过接口电路实现。计算机与内存及所有设备的连接都是基于总线的，即地址总线 AB、数据总线 DB、控制总线 CB；因此需要了解总线上的数据来自于哪个设备，同时也需要考虑计算机的控制量如何送入某台具体设备，这就是所谓的选址。

### 输入输出接口的编址方式

外围通道的地址对 CPU 来说有两种编址方式：统一编址方式（存储器）和独立编址方式，一般根据使用的 CPU 类型类确定 IO 接口的编址方式。本课程讨论的机器基本为隔离 IO，当然也可以人为设置成存储器映像 IO

- 存储器映像 I/O（又称统一编址方式）

  8088 上有$$\overline{MERQ}$$和$$\overline{IORQ}$$信号，用于选择 CPU 此时是与内存交互还是与外部设备交互；8086 上则将它们合并为$$IO/\overline{M}$$信号。$$\overline{RD}$$为读信号（将 CPU 信号送到外部设备），$$\overline{WR}$$为写信号（将外部设备信号送入 CPU），$$A_x$$为地址信号（图中的$$A_{15}$$表示有 16 为地址线，对应 0~65535byte，即 64kb 的内存）。图中的结构控制 0-7FFFH 为内存空间，8000H-FFFFH 为外部存储器空间。在这种编址方式中，外设是占用内存的。

  ![image-20250310133014075](../assets/post-pics/image-20250310133014075.png)

  这种编址方式的优点是：

  - CPU 对外围的操作可使用全部的存储器操作指令，简化了指令系统的设计，不必单独包含 IO 操作指令
  - 内存和外设的地址分布图是同一个

  - IO 地址数几乎不受限制

  这种编址方式的缺点是：

  - 外设占用内存单元，使内存容量减小
  - 需要全字长的地址译码，需要使用更复杂的译码器芯片，指令操作的时间也有所延长
  - 程序中较难区分是否为/O 操作，程序可读性较差

---

- 隔离 IO（又称独立编址方式）

  需要专用的输入输出指令 IN/OUT 来访问外围端口，且仅限于对累加器进行操作，这增加了程序的复杂性，即必须将外部设备的数据送入累加器，再对累加器中的数据进行操作。

  ```assembly
  IN AL, n;  // 把外部数据送入AL寄存器中
  OUT n, AL; // 把AL中数据输出给外部设备
  ```

  并且要注意，隔离 IO 使用的是端口地址，且一个外部设备可能有多个端口。

  （一个外设不仅有数据寄存器，还有状态寄存器和控制命令寄存器，它们各需要一个地址
  单元（也称为端口 port）才能加以区分，故一个外设往往需要数个端口地址）

  这种编址方式的优点是：

  - 可读性好，指令与访问存储器的指令有明显区别，程序清晰

  - IO 指令长度段，执行速度快，占用内存空间少

  - IO 译码电路简单

  这种编址方式的缺点是：

  - CPU 的指令系统中必须有专门的 IN 和 OUT 指令

  - IO 指令的功能没有访问存储器的指令功能强大

### 直接寻址输入输出的时序

了解时序的目的是明白一条指令执行的过程中 CPU 为用户提供的信号，这些信号在时间上的配合关系，并要求接口电路设计选用的三态门电路和输出寄存器动作时序要和指令时序一致。

执行输入输出指令时，地址总线上为外部设备的端口地址，数据总线上为要传输的数据，控制总线上为选通 IO 操作时对应的电平。IN 指令时$$\overline{RD}$$信号有效，OUT 指令时$$\overline{WR}$$信号有效。

第一个机器周期内采样地址总线的变化，然后如果有需要输出的数据，此时就应该准备好；第二个机器周期采样 IO 选通信号，并采样读或写信号（图中把读写都画成有效了，实际运行时只有一个为有效电平）；然后是可能插入的一个或多个等待周期，确保程序能准确运行；第三个机器周期采样要读入的信号。把从第一个周期的上升沿到下一个周期的上升沿称为输入输出周期，不同指令输入输出周期的长短可能不同（如传输 16 位的指令耗时就多于传输 8 位的指令）

### 译码器

译码器就是把给定的地址代码进行“翻译”，变成相应的状态信号，用以选择不同的存储器及外设的芯片。在本课程的接口中，最常用的是三——八译码器 74LS138。

### 中断

中断是 CPU 一种处理外界实时信息的功能。

==中断的优点：提高 CPU 的工作效率、CPU 响应中断的条件、中断响应的过程==

### 接口

接口电路是沟通 CPU 与外围通道之间信息交换的桥梁，是计算机控制系统中必不可少的部件。

接口的目的：

- 协调 CPU 与独立的外部设备之间的数据传输（执行协调工作的控制信号称为握手信号）
- 进行数据格式的转换（模数转换，串并行转换）
- 实现电气隔离、放大，消除干扰等

常见的接口的类型包括：

- 并行 I/O 接口：CPU 内部总线是并行 IO
- AD 转换接口
- D/A 转换接口
- 实时时钟接口：距离较远的设备保持时间一致性
- DMA 控制接口：外设与内存之间直接的数据交换而不用通过 CPU，CPU 出让三总线控制权给 DMA 控制器，实现大批量数据传输，多用于操作指导控制系统，以及大量数据采集等场合
- 串行通讯接口：线数少、传输距离长、传输速率相对慢，串行通讯芯片有 8251
- 并行通讯接口：线数多、传输距离短、传输速率相对快，并行通讯芯片有 8255
- 网络通讯接口：集散控制系统、分布式控制系统中常用

### 并行 IO 接口

- 无条件传送（简单 IO 方式）：外设和 CPU 直接进行数据交互，只有在外部控制过程的各种动作时间是固定且已知的条件下才能使用，因此又称为同步方式。系统构成需要输入缓冲、输出锁存以及端口地址译码，13 构成简单输入方式，23 构成简单输出方式
